(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();const Vl=!1,Gl=(e,t)=>e===t,at=Symbol("solid-proxy"),pl=typeof Proxy=="function",Cn=Symbol("solid-track"),on={equals:Gl};let xl=Sl;const $t=1,cn=2,vl={owned:null,cleanups:null,context:null,owner:null};var we=null;let xn=null,Yl=null,Ce=null,qe=null,mt=null,hn=0;function rn(e,t){const n=Ce,l=we,r=e.length===0,i=t===void 0?l:t,o=r?vl:{owned:null,cleanups:null,context:i?i.context:null,owner:i},c=r?e:()=>e(()=>lt(()=>Bt(o)));we=o,Ce=null;try{return Ut(c,!0)}finally{Ce=n,we=l}}function Ie(e,t){t=t?Object.assign({},on,t):on;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},l=r=>(typeof r=="function"&&(r=r(n.value)),_l(n,r));return[$l.bind(n),l]}function U(e,t,n){const l=Ln(e,t,!1,$t);Wt(l)}function gt(e,t,n){xl=er;const l=Ln(e,t,!1,$t);l.user=!0,mt?mt.push(l):Wt(l)}function z(e,t,n){n=n?Object.assign({},on,n):on;const l=Ln(e,t,!0,0);return l.observers=null,l.observerSlots=null,l.comparator=n.equals||void 0,Wt(l),$l.bind(l)}function Ql(e){return Ut(e,!1)}function lt(e){if(Ce===null)return e();const t=Ce;Ce=null;try{return e()}finally{Ce=t}}function wl(e){gt(()=>lt(e))}function gn(e){return we===null||(we.cleanups===null?we.cleanups=[e]:we.cleanups.push(e)),e}function Pn(){return Ce}function Wl(e,t){const n=Symbol("context");return{id:n,Provider:nr(n),defaultValue:e}}function Xl(e){let t;return we&&we.context&&(t=we.context[e.id])!==void 0?t:e.defaultValue}function Hl(e){const t=z(e),n=z(()=>An(t()));return n.toArray=()=>{const l=n();return Array.isArray(l)?l:l!=null?[l]:[]},n}function $l(){if(this.sources&&this.state)if(this.state===$t)Wt(this);else{const e=qe;qe=null,Ut(()=>un(this),!1),qe=e}if(Ce){const e=this.observers?this.observers.length:0;Ce.sources?(Ce.sources.push(this),Ce.sourceSlots.push(e)):(Ce.sources=[this],Ce.sourceSlots=[e]),this.observers?(this.observers.push(Ce),this.observerSlots.push(Ce.sources.length-1)):(this.observers=[Ce],this.observerSlots=[Ce.sources.length-1])}return this.value}function _l(e,t,n){let l=e.value;return(!e.comparator||!e.comparator(l,t))&&(e.value=t,e.observers&&e.observers.length&&Ut(()=>{for(let r=0;r<e.observers.length;r+=1){const i=e.observers[r],o=xn&&xn.running;o&&xn.disposed.has(i),(o?!i.tState:!i.state)&&(i.pure?qe.push(i):mt.push(i),i.observers&&kl(i)),o||(i.state=$t)}if(qe.length>1e6)throw qe=[],new Error},!1)),t}function Wt(e){if(!e.fn)return;Bt(e);const t=hn;Jl(e,e.value,t)}function Jl(e,t,n){let l;const r=we,i=Ce;Ce=we=e;try{l=e.fn(t)}catch(o){return e.pure&&(e.state=$t,e.owned&&e.owned.forEach(Bt),e.owned=null),e.updatedAt=n+1,Cl(o)}finally{Ce=i,we=r}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?_l(e,l):e.value=l,e.updatedAt=n)}function Ln(e,t,n,l=$t,r){const i={fn:e,state:l,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:we,context:we?we.context:null,pure:n};return we===null||we!==vl&&(we.owned?we.owned.push(i):we.owned=[i]),i}function dn(e){if(e.state===0)return;if(e.state===cn)return un(e);if(e.suspense&&lt(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<hn);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===$t)Wt(e);else if(e.state===cn){const l=qe;qe=null,Ut(()=>un(e,t[0]),!1),qe=l}}function Ut(e,t){if(qe)return e();let n=!1;t||(qe=[]),mt?n=!0:mt=[],hn++;try{const l=e();return Zl(n),l}catch(l){n||(mt=null),qe=null,Cl(l)}}function Zl(e){if(qe&&(Sl(qe),qe=null),e)return;const t=mt;mt=null,t.length&&Ut(()=>xl(t),!1)}function Sl(e){for(let t=0;t<e.length;t++)dn(e[t])}function er(e){let t,n=0;for(t=0;t<e.length;t++){const l=e[t];l.user?e[n++]=l:dn(l)}for(t=0;t<n;t++)dn(e[t])}function un(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const l=e.sources[n];if(l.sources){const r=l.state;r===$t?l!==t&&(!l.updatedAt||l.updatedAt<hn)&&dn(l):r===cn&&un(l,t)}}}function kl(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=cn,n.pure?qe.push(n):mt.push(n),n.observers&&kl(n))}}function Bt(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),l=e.sourceSlots.pop(),r=n.observers;if(r&&r.length){const i=r.pop(),o=n.observerSlots.pop();l<r.length&&(i.sourceSlots[o]=l,r[l]=i,n.observerSlots[l]=o)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)Bt(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)Bt(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function tr(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Cl(e,t=we){throw tr(e)}function An(e){if(typeof e=="function"&&!e.length)return An(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const l=An(e[n]);Array.isArray(l)?t.push.apply(t,l):t.push(l)}return t}return e}function nr(e,t){return function(l){let r;return U(()=>r=lt(()=>(we.context={...we.context,[e]:l.value},Hl(()=>l.children))),void 0),r}}const lr=Symbol("fallback");function jn(e){for(let t=0;t<e.length;t++)e[t]()}function rr(e,t,n={}){let l=[],r=[],i=[],o=0,c=t.length>1?[]:null;return gn(()=>jn(i)),()=>{let u=e()||[],$=u.length,P,p;return u[Cn],lt(()=>{let J,le,re,V,se,_e,fe,F,Pe;if($===0)o!==0&&(jn(i),i=[],l=[],r=[],o=0,c&&(c=[])),n.fallback&&(l=[lr],r[0]=rn(Se=>(i[0]=Se,n.fallback())),o=1);else if(o===0){for(r=new Array($),p=0;p<$;p++)l[p]=u[p],r[p]=rn(j);o=$}else{for(re=new Array($),V=new Array($),c&&(se=new Array($)),_e=0,fe=Math.min(o,$);_e<fe&&l[_e]===u[_e];_e++);for(fe=o-1,F=$-1;fe>=_e&&F>=_e&&l[fe]===u[F];fe--,F--)re[F]=r[fe],V[F]=i[fe],c&&(se[F]=c[fe]);for(J=new Map,le=new Array(F+1),p=F;p>=_e;p--)Pe=u[p],P=J.get(Pe),le[p]=P===void 0?-1:P,J.set(Pe,p);for(P=_e;P<=fe;P++)Pe=l[P],p=J.get(Pe),p!==void 0&&p!==-1?(re[p]=r[P],V[p]=i[P],c&&(se[p]=c[P]),p=le[p],J.set(Pe,p)):i[P]();for(p=_e;p<$;p++)p in re?(r[p]=re[p],i[p]=V[p],c&&(c[p]=se[p],c[p](p))):r[p]=rn(j);r=r.slice(0,o=$),l=u.slice(0)}return r});function j(J){if(i[p]=J,c){const[le,re]=Ie(p);return c[p]=re,t(u[p],le)}return t(u[p])}}}function f(e,t){return lt(()=>e(t||{}))}function Zt(){return!0}const Nn={get(e,t,n){return t===at?n:e.get(t)},has(e,t){return t===at?!0:e.has(t)},set:Zt,deleteProperty:Zt,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:Zt,deleteProperty:Zt}},ownKeys(e){return e.keys()}};function vn(e){return(e=typeof e=="function"?e():e)?e:{}}function ir(){for(let e=0,t=this.length;e<t;++e){const n=this[e]();if(n!==void 0)return n}}function he(...e){let t=!1;for(let o=0;o<e.length;o++){const c=e[o];t=t||!!c&&at in c,e[o]=typeof c=="function"?(t=!0,z(c)):c}if(pl&&t)return new Proxy({get(o){for(let c=e.length-1;c>=0;c--){const u=vn(e[c])[o];if(u!==void 0)return u}},has(o){for(let c=e.length-1;c>=0;c--)if(o in vn(e[c]))return!0;return!1},keys(){const o=[];for(let c=0;c<e.length;c++)o.push(...Object.keys(vn(e[c])));return[...new Set(o)]}},Nn);const n={},l=Object.create(null);for(let o=e.length-1;o>=0;o--){const c=e[o];if(!c)continue;const u=Object.getOwnPropertyNames(c);for(let $=u.length-1;$>=0;$--){const P=u[$];if(P==="__proto__"||P==="constructor")continue;const p=Object.getOwnPropertyDescriptor(c,P);if(!l[P])l[P]=p.get?{enumerable:!0,configurable:!0,get:ir.bind(n[P]=[p.get.bind(c)])}:p.value!==void 0?p:void 0;else{const j=n[P];j&&(p.get?j.push(p.get.bind(c)):p.value!==void 0&&j.push(()=>p.value))}}}const r={},i=Object.keys(l);for(let o=i.length-1;o>=0;o--){const c=i[o],u=l[c];u&&u.get?Object.defineProperty(r,c,u):r[c]=u?u.value:void 0}return r}function Pl(e,...t){const n=t.length;if(pl&&at in e){const r=n>1?t.flat():t[0],i=t.map(o=>new Proxy({get(c){return o.includes(c)?e[c]:void 0},has(c){return o.includes(c)&&c in e},keys(){return o.filter(c=>c in e)}},Nn));return i.push(new Proxy({get(o){return r.includes(o)?void 0:e[o]},has(o){return r.includes(o)?!1:o in e},keys(){return Object.keys(e).filter(o=>!r.includes(o))}},Nn)),i}const l=[];for(let r=0;r<=n;r++)l[r]={};for(const r of Object.getOwnPropertyNames(e)){let i=n;for(let u=0;u<t.length;u++)if(t[u].includes(r)){i=u;break}const o=Object.getOwnPropertyDescriptor(e,r);!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable?l[i][r]=o.value:Object.defineProperty(l[i],r,o)}return l}const sr=e=>`Stale read from <${e}>.`;function ye(e){const t="fallback"in e&&{fallback:()=>e.fallback};return z(rr(()=>e.each,e.children,t||void 0))}function L(e){const t=e.keyed,n=z(()=>e.when,void 0,void 0),l=t?n:z(n,void 0,{equals:(r,i)=>!r==!i});return z(()=>{const r=l();if(r){const i=e.children;return typeof i=="function"&&i.length>0?lt(()=>i(t?r:()=>{if(!lt(l))throw sr("Show");return n()})):i}return e.fallback},void 0,void 0)}const ar=["allowfullscreen","async","alpha","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected","adauctionheaders","browsingtopics","credentialless","defaultchecked","defaultmuted","defaultselected","defer","disablepictureinpicture","disableremoteplayback","preservespitch","shadowrootclonable","shadowrootcustomelementregistry","shadowrootdelegatesfocus","shadowrootserializable","sharedstoragewritable"],or=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline","adAuctionHeaders","allowFullscreen","browsingTopics","defaultChecked","defaultMuted","defaultSelected","disablePictureInPicture","disableRemotePlayback","preservesPitch","shadowRootClonable","shadowRootCustomElementRegistry","shadowRootDelegatesFocus","shadowRootSerializable","sharedStorageWritable",...ar]),cr=new Set(["innerHTML","textContent","innerText","children"]),dr=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),ur=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1},adauctionheaders:{$:"adAuctionHeaders",IFRAME:1},allowfullscreen:{$:"allowFullscreen",IFRAME:1},browsingtopics:{$:"browsingTopics",IMG:1},defaultchecked:{$:"defaultChecked",INPUT:1},defaultmuted:{$:"defaultMuted",AUDIO:1,VIDEO:1},defaultselected:{$:"defaultSelected",OPTION:1},disablepictureinpicture:{$:"disablePictureInPicture",VIDEO:1},disableremoteplayback:{$:"disableRemotePlayback",AUDIO:1,VIDEO:1},preservespitch:{$:"preservesPitch",AUDIO:1,VIDEO:1},shadowrootclonable:{$:"shadowRootClonable",TEMPLATE:1},shadowrootdelegatesfocus:{$:"shadowRootDelegatesFocus",TEMPLATE:1},shadowrootserializable:{$:"shadowRootSerializable",TEMPLATE:1},sharedstoragewritable:{$:"sharedStorageWritable",IFRAME:1,IMG:1}});function fr(e,t){const n=ur[e];return typeof n=="object"?n[t]?n.$:void 0:n}const br=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),yr=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),hr={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},et=e=>z(()=>e());function gr(e,t,n){let l=n.length,r=t.length,i=l,o=0,c=0,u=t[r-1].nextSibling,$=null;for(;o<r||c<i;){if(t[o]===n[c]){o++,c++;continue}for(;t[r-1]===n[i-1];)r--,i--;if(r===o){const P=i<l?c?n[c-1].nextSibling:n[i-c]:u;for(;c<i;)e.insertBefore(n[c++],P)}else if(i===c)for(;o<r;)(!$||!$.has(t[o]))&&t[o].remove(),o++;else if(t[o]===n[i-1]&&n[c]===t[r-1]){const P=t[--r].nextSibling;e.insertBefore(n[c++],t[o++].nextSibling),e.insertBefore(n[--i],P),t[r]=n[i]}else{if(!$){$=new Map;let p=c;for(;p<i;)$.set(n[p],p++)}const P=$.get(t[o]);if(P!=null)if(c<P&&P<i){let p=o,j=1,J;for(;++p<r&&p<i&&!((J=$.get(t[p]))==null||J!==P+j);)j++;if(j>P-c){const le=t[o];for(;c<P;)e.insertBefore(n[c++],le)}else e.replaceChild(n[c++],t[o++])}else o++;else t[o++].remove()}}}const Fn="_$DX_DELEGATE";function mr(e,t,n,l={}){let r;return rn(i=>{r=i,t===document?e():a(t,e(),t.firstChild?null:void 0,n)},l.owner),()=>{r(),t.textContent=""}}function C(e,t,n,l){let r;const i=()=>{const c=l?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return c.innerHTML=e,n?c.content.firstChild.firstChild:l?c.firstChild:c.content.firstChild},o=t?()=>lt(()=>document.importNode(r||(r=i()),!0)):()=>(r||(r=i())).cloneNode(!0);return o.cloneNode=o,o}function jt(e,t=window.document){const n=t[Fn]||(t[Fn]=new Set);for(let l=0,r=e.length;l<r;l++){const i=e[l];n.has(i)||(n.add(i),t.addEventListener(i,Sr))}}function be(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function pr(e,t,n,l){l==null?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,l)}function xr(e,t,n){n?e.setAttribute(t,""):e.removeAttribute(t)}function pe(e,t){t==null?e.removeAttribute("class"):e.className=t}function Al(e,t,n,l){if(l)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const r=n[0];e.addEventListener(t,n[0]=i=>r.call(e,n[1],i))}else e.addEventListener(t,n,typeof n!="function"&&n)}function vr(e,t,n={}){const l=Object.keys(t||{}),r=Object.keys(n);let i,o;for(i=0,o=r.length;i<o;i++){const c=r[i];!c||c==="undefined"||t[c]||(zn(e,c,!1),delete n[c])}for(i=0,o=l.length;i<o;i++){const c=l[i],u=!!t[c];!c||c==="undefined"||n[c]===u||!u||(zn(e,c,!0),n[c]=u)}return n}function Nl(e,t,n){if(!t)return n?be(e,"style"):t;const l=e.style;if(typeof t=="string")return l.cssText=t;typeof n=="string"&&(l.cssText=n=void 0),n||(n={}),t||(t={});let r,i;for(i in n)t[i]==null&&l.removeProperty(i),delete n[i];for(i in t)r=t[i],r!==n[i]&&(l.setProperty(i,r),n[i]=r);return n}function wr(e,t,n){n!=null?e.style.setProperty(t,n):e.style.removeProperty(t)}function Tl(e,t={},n,l){const r={};return l||U(()=>r.children=Vt(e,t.children,r.children)),U(()=>typeof t.ref=="function"&&sn(t.ref,e)),U(()=>$r(e,t,n,!0,r,!0)),r}function sn(e,t,n){return lt(()=>e(t,n))}function a(e,t,n,l){if(n!==void 0&&!l&&(l=[]),typeof t!="function")return Vt(e,t,l,n);U(r=>Vt(e,t(),r,n),l)}function $r(e,t,n,l,r={},i=!1){t||(t={});for(const o in r)if(!(o in t)){if(o==="children")continue;r[o]=Rn(e,o,null,r[o],n,i,t)}for(const o in t){if(o==="children")continue;const c=t[o];r[o]=Rn(e,o,c,r[o],n,i,t)}}function _r(e){return e.toLowerCase().replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}function zn(e,t,n){const l=t.trim().split(/\s+/);for(let r=0,i=l.length;r<i;r++)e.classList.toggle(l[r],n)}function Rn(e,t,n,l,r,i,o){let c,u,$,P,p;if(t==="style")return Nl(e,n,l);if(t==="classList")return vr(e,n,l);if(n===l)return l;if(t==="ref")i||n(e);else if(t.slice(0,3)==="on:"){const j=t.slice(3);l&&e.removeEventListener(j,l,typeof l!="function"&&l),n&&e.addEventListener(j,n,typeof n!="function"&&n)}else if(t.slice(0,10)==="oncapture:"){const j=t.slice(10);l&&e.removeEventListener(j,l,!0),n&&e.addEventListener(j,n,!0)}else if(t.slice(0,2)==="on"){const j=t.slice(2).toLowerCase(),J=br.has(j);if(!J&&l){const le=Array.isArray(l)?l[0]:l;e.removeEventListener(j,le)}(J||n)&&(Al(e,j,n,J),J&&jt([j]))}else if(t.slice(0,5)==="attr:")be(e,t.slice(5),n);else if(t.slice(0,5)==="bool:")xr(e,t.slice(5),n);else if((p=t.slice(0,5)==="prop:")||($=cr.has(t))||!r&&((P=fr(t,e.tagName))||(u=or.has(t)))||(c=e.nodeName.includes("-")||"is"in o))p&&(t=t.slice(5),u=!0),t==="class"||t==="className"?pe(e,n):c&&!u&&!$?e[_r(t)]=n:e[P||t]=n;else{const j=r&&t.indexOf(":")>-1&&hr[t.split(":")[0]];j?pr(e,j,t,n):be(e,dr[t]||t,n)}return n}function Sr(e){let t=e.target;const n=`$$${e.type}`,l=e.target,r=e.currentTarget,i=u=>Object.defineProperty(e,"target",{configurable:!0,value:u}),o=()=>{const u=t[n];if(u&&!t.disabled){const $=t[`${n}Data`];if($!==void 0?u.call(t,$,e):u.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&i(t.host),!0},c=()=>{for(;o()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const u=e.composedPath();i(u[0]);for(let $=0;$<u.length-2&&(t=u[$],!!o());$++){if(t._$host){t=t._$host,c();break}if(t.parentNode===r)break}}else c();i(l)}function Vt(e,t,n,l,r){for(;typeof n=="function";)n=n();if(t===n)return n;const i=typeof t,o=l!==void 0;if(e=o&&n[0]&&n[0].parentNode||e,i==="string"||i==="number"){if(i==="number"&&(t=t.toString(),t===n))return n;if(o){let c=n[0];c&&c.nodeType===3?c.data!==t&&(c.data=t):c=document.createTextNode(t),n=Pt(e,n,l,c)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||i==="boolean")n=Pt(e,n,l);else{if(i==="function")return U(()=>{let c=t();for(;typeof c=="function";)c=c();n=Vt(e,c,n,l)}),()=>n;if(Array.isArray(t)){const c=[],u=n&&Array.isArray(n);if(Tn(c,t,n,r))return U(()=>n=Vt(e,c,n,l,!0)),()=>n;if(c.length===0){if(n=Pt(e,n,l),o)return n}else u?n.length===0?Kn(e,c,l):gr(e,n,c):(n&&Pt(e),Kn(e,c));n=c}else if(t.nodeType){if(Array.isArray(n)){if(o)return n=Pt(e,n,l,t);Pt(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Tn(e,t,n,l){let r=!1;for(let i=0,o=t.length;i<o;i++){let c=t[i],u=n&&n[e.length],$;if(!(c==null||c===!0||c===!1))if(($=typeof c)=="object"&&c.nodeType)e.push(c);else if(Array.isArray(c))r=Tn(e,c,u)||r;else if($==="function")if(l){for(;typeof c=="function";)c=c();r=Tn(e,Array.isArray(c)?c:[c],Array.isArray(u)?u:[u])||r}else e.push(c),r=!0;else{const P=String(c);u&&u.nodeType===3&&u.data===P?e.push(u):e.push(document.createTextNode(P))}}return r}function Kn(e,t,n=null){for(let l=0,r=t.length;l<r;l++)e.insertBefore(t[l],n)}function Pt(e,t,n,l){if(n===void 0)return e.textContent="";const r=l||document.createTextNode("");if(t.length){let i=!1;for(let o=t.length-1;o>=0;o--){const c=t[o];if(r!==c){const u=c.parentNode===e;!i&&!o?u?e.replaceChild(r,c):e.insertBefore(r,n):u&&c.remove()}else i=!0}}else e.insertBefore(r,n);return[r]}const kr="http://www.w3.org/2000/svg";function Cr(e,t=!1,n=void 0){return t?document.createElementNS(kr,e):document.createElement(e,{is:n})}function Pr(e,t){const n=z(e);return z(()=>{const l=n();switch(typeof l){case"function":return lt(()=>l(t));case"string":const r=yr.has(l),i=Cr(l,r,lt(()=>t.is));return Tl(i,t,r),i}})}function Ml(e){const[,t]=Pl(e,["component"]);return Pr(()=>e.component,t)}const At={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var Ar=C("<svg>");const Nr=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xe=e=>{const[t,n]=Pl(e,["color","size","strokeWidth","children","class","name","iconNode","absoluteStrokeWidth"]);return(()=>{var l=Ar();return Tl(l,he(At,{get width(){return t.size??At.width},get height(){return t.size??At.height},get stroke(){return t.color??At.stroke},get"stroke-width"(){return et(()=>!!t.absoluteStrokeWidth)()?Number(t.strokeWidth??At["stroke-width"])*24/Number(t.size):Number(t.strokeWidth??At["stroke-width"])},get class(){return`lucide lucide-${Nr((t==null?void 0:t.name)??"icon")} ${t.class!=null?t.class:""}`}},n),!0,!0),a(l,f(ye,{get each(){return t.iconNode},children:([r,i])=>f(Ml,he({component:r},i))})),l})()},Tr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Mr=e=>f(xe,he(e,{name:"AlertCircle",iconNode:Tr})),Er=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Lr=e=>f(xe,he(e,{name:"CheckCircle2",iconNode:Er})),Or=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Dr=e=>f(xe,he(e,{name:"ChevronDown",iconNode:Or})),Ur=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],jr=e=>f(xe,he(e,{name:"Database",iconNode:Ur})),Fr=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m8 17 4 4 4-4",key:"1ul180"}]],zr=e=>f(xe,he(e,{name:"DownloadCloud",iconNode:Fr})),Rr=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Kr=e=>f(xe,he(e,{name:"ExternalLink",iconNode:Rr})),Ir=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],qr=e=>f(xe,he(e,{name:"Film",iconNode:Ir})),Br=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],Vr=e=>f(xe,he(e,{name:"Filter",iconNode:Br})),Gr=[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]],Yr=e=>f(xe,he(e,{name:"Layers",iconNode:Gr})),Qr=[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]],Wr=e=>f(xe,he(e,{name:"Loader",iconNode:Qr})),Xr=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],Hr=e=>f(xe,he(e,{name:"Music",iconNode:Xr})),Jr=[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]],Zr=e=>f(xe,he(e,{name:"Pause",iconNode:Jr})),ei=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]],ti=e=>f(xe,he(e,{name:"PlayCircle",iconNode:ei})),ni=[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]],li=e=>f(xe,he(e,{name:"Play",iconNode:ni})),ri=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],ii=e=>f(xe,he(e,{name:"PlusCircle",iconNode:ri})),si=[["path",{d:"M19.439 7.85c-.049.322.059.648.289.878l1.568 1.568c.47.47.706 1.087.706 1.704s-.235 1.233-.706 1.704l-1.611 1.611a.98.98 0 0 1-.837.276c-.47-.07-.802-.48-.968-.925a2.501 2.501 0 1 0-3.214 3.214c.446.166.855.497.925.968a.979.979 0 0 1-.276.837l-1.61 1.61a2.404 2.404 0 0 1-1.705.707 2.402 2.402 0 0 1-1.704-.706l-1.568-1.568a1.026 1.026 0 0 0-.877-.29c-.493.074-.84.504-1.02.968a2.5 2.5 0 1 1-3.237-3.237c.464-.18.894-.527.967-1.02a1.026 1.026 0 0 0-.289-.877l-1.568-1.568A2.402 2.402 0 0 1 1.998 12c0-.617.236-1.234.706-1.704L4.23 8.77c.24-.24.581-.353.917-.303.515.077.877.528 1.073 1.01a2.5 2.5 0 1 0 3.259-3.259c-.482-.196-.933-.558-1.01-1.073-.05-.336.062-.676.303-.917l1.525-1.525A2.402 2.402 0 0 1 12 1.998c.617 0 1.234.236 1.704.706l1.568 1.568c.23.23.556.338.877.29.493-.074.84-.504 1.02-.968a2.5 2.5 0 1 1 3.237 3.237c-.464.18-.894.527-.967 1.02Z",key:"i0oyt7"}]],ai=e=>f(xe,he(e,{name:"Puzzle",iconNode:si})),oi=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],ci=e=>f(xe,he(e,{name:"Search",iconNode:oi})),di=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ui=e=>f(xe,he(e,{name:"ShieldCheck",iconNode:di})),fi=[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]],bi=e=>f(xe,he(e,{name:"SkipBack",iconNode:fi})),yi=[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]],hi=e=>f(xe,he(e,{name:"SkipForward",iconNode:yi})),gi=[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]],mi=e=>f(xe,he(e,{name:"Sliders",iconNode:gi})),pi=[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]],xi=e=>f(xe,he(e,{name:"Terminal",iconNode:pi})),vi=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],wi=e=>f(xe,he(e,{name:"Trash2",iconNode:vi})),$i=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],_i=e=>f(xe,he(e,{name:"X",iconNode:$i})),Si=[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]],ki=e=>f(xe,he(e,{name:"Zap",iconNode:Si})),In={zap:ki,"plus-circle":ii,layers:Yr,sliders:mi,puzzle:ai,"chevron-down":Dr,"trash-2":wi,"download-cloud":zr,music:Hr,"shield-check":ui,database:jr,"alert-circle":Mr,"check-circle-2":Lr,loader:Wr,terminal:xi,search:ci,filter:Vr,film:qr,play:li,"external-link":Kr,x:_i,"play-circle":ti,"skip-back":bi,pause:Zr,"skip-forward":hi};function ie(e){const t=In[e.name]||In["alert-circle"];return f(Ml,{component:t,get class(){return e.class}})}var Ci=C('<div class="text-[11px] text-gray-600 mt-2 break-all">'),Pi=C('<div class="p-3 rounded-xl bg-red-500/10 border border-red-500/20 text-red-400 text-xs">'),Ai=C('<div class="fixed inset-0 z-50 bg-[#05070a]/80 backdrop-blur-sm flex items-center justify-center p-4"><div class="w-full max-w-2xl rounded-3xl border border-white/10 bg-[#0a0c14] shadow-2xl p-8 space-y-6 animate-in fade-in zoom-in-95 duration-300"><div class="flex items-center gap-3"><div class="p-2 rounded-xl bg-amber-500/10 text-amber-400"></div><div><div class="font-bold text-white text-xl">Duplicate File Detected</div><div class="text-xs text-gray-500">Choose how to handle this file.</div></div></div><div class="p-4 rounded-2xl border border-white/10 bg-[#05070a]"><div class="text-xs text-gray-500 mb-1">Filename</div><div class="text-sm text-white font-mono break-all"></div></div><div class="grid grid-cols-1 md:grid-cols-2 gap-3">'),Ni=C('<button class="text-left p-4 rounded-2xl border border-white/10 bg-white/5 hover:border-blue-500/40 hover:bg-blue-500/10 transition-all"><div class="flex items-center justify-between"><span class="font-bold text-white text-sm"></span><span class="text-[10px] px-2 py-0.5 rounded-full bg-white/10 text-gray-400 font-mono"></span></div><div class="text-xs text-gray-500 mt-1">');const Ti=[{value:"overwrite",label:"Overwrite",hint:"Replace this file",key:"o"},{value:"overwrite_all",label:"Overwrite All",hint:"Replace all duplicates in this job",key:"O"},{value:"skip",label:"Skip",hint:"Skip this file",key:"s"},{value:"skip_all",label:"Skip All",hint:"Skip all duplicates in this job",key:"S"},{value:"rename",label:"Rename",hint:"Save as next available filename",key:"r"},{value:"rename_all",label:"Rename All",hint:"Rename all duplicates in this job",key:"R"},{value:"cancel",label:"Cancel",hint:"Abort this item",key:"q"}];function Mi(e){return(()=>{var t=Ai(),n=t.firstChild,l=n.firstChild,r=l.firstChild,i=l.nextSibling,o=i.firstChild,c=o.nextSibling,u=i.nextSibling;return a(r,f(ie,{name:"alert-circle",class:"w-5 h-5"})),a(c,()=>{var $;return(($=e.prompt)==null?void 0:$.filename)||"Unknown file"}),a(i,f(L,{get when(){var $;return($=e.prompt)==null?void 0:$.path},get children(){var $=Ci();return a($,()=>e.prompt.path),$}}),null),a(n,f(L,{get when(){return e.error},get children(){var $=Pi();return a($,()=>e.error),$}}),u),a(u,f(ye,{each:Ti,children:$=>(()=>{var P=Ni(),p=P.firstChild,j=p.firstChild,J=j.nextSibling,le=p.nextSibling;return P.$$click=()=>{var re;return(re=e.onSelect)==null?void 0:re.call(e,$.value)},a(j,()=>$.label),a(J,()=>$.key),a(le,()=>$.hint),P})()})),t})()}jt(["click"]);const Mn=Symbol("store-raw"),Ot=Symbol("store-node"),ht=Symbol("store-has"),El=Symbol("store-self");function Ll(e){let t=e[at];if(!t&&(Object.defineProperty(e,at,{value:t=new Proxy(e,Oi)}),!Array.isArray(e))){const n=Object.keys(e),l=Object.getOwnPropertyDescriptors(e);for(let r=0,i=n.length;r<i;r++){const o=n[r];l[o].get&&Object.defineProperty(e,o,{enumerable:l[o].enumerable,get:l[o].get.bind(t)})}}return t}function fn(e){let t;return e!=null&&typeof e=="object"&&(e[at]||!(t=Object.getPrototypeOf(e))||t===Object.prototype||Array.isArray(e))}function Gt(e,t=new Set){let n,l,r,i;if(n=e!=null&&e[Mn])return n;if(!fn(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let o=0,c=e.length;o<c;o++)r=e[o],(l=Gt(r,t))!==r&&(e[o]=l)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const o=Object.keys(e),c=Object.getOwnPropertyDescriptors(e);for(let u=0,$=o.length;u<$;u++)i=o[u],!c[i].get&&(r=e[i],(l=Gt(r,t))!==r&&(e[i]=l))}return e}function bn(e,t){let n=e[t];return n||Object.defineProperty(e,t,{value:n=Object.create(null)}),n}function Yt(e,t,n){if(e[t])return e[t];const[l,r]=Ie(n,{equals:!1,internal:!0});return l.$=r,e[t]=l}function Ei(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===at||t===Ot||(delete n.value,delete n.writable,n.get=()=>e[at][t]),n}function Ol(e){Pn()&&Yt(bn(e,Ot),El)()}function Li(e){return Ol(e),Reflect.ownKeys(e)}const Oi={get(e,t,n){if(t===Mn)return e;if(t===at)return n;if(t===Cn)return Ol(e),n;const l=bn(e,Ot),r=l[t];let i=r?r():e[t];if(t===Ot||t===ht||t==="__proto__")return i;if(!r){const o=Object.getOwnPropertyDescriptor(e,t);Pn()&&(typeof i!="function"||e.hasOwnProperty(t))&&!(o&&o.get)&&(i=Yt(l,t,i)())}return fn(i)?Ll(i):i},has(e,t){return t===Mn||t===at||t===Cn||t===Ot||t===ht||t==="__proto__"?!0:(Pn()&&Yt(bn(e,ht),t)(),t in e)},set(){return!0},deleteProperty(){return!0},ownKeys:Li,getOwnPropertyDescriptor:Ei};function yn(e,t,n,l=!1){if(!l&&e[t]===n)return;const r=e[t],i=e.length;n===void 0?(delete e[t],e[ht]&&e[ht][t]&&r!==void 0&&e[ht][t].$()):(e[t]=n,e[ht]&&e[ht][t]&&r===void 0&&e[ht][t].$());let o=bn(e,Ot),c;if((c=Yt(o,t,r))&&c.$(()=>n),Array.isArray(e)&&e.length!==i){for(let u=e.length;u<i;u++)(c=o[u])&&c.$();(c=Yt(o,"length",i))&&c.$(e.length)}(c=o[El])&&c.$()}function Dl(e,t){const n=Object.keys(t);for(let l=0;l<n.length;l+=1){const r=n[l];yn(e,r,t[r])}}function Di(e,t){if(typeof t=="function"&&(t=t(e)),t=Gt(t),Array.isArray(t)){if(e===t)return;let n=0,l=t.length;for(;n<l;n++){const r=t[n];e[n]!==r&&yn(e,n,r)}yn(e,"length",l)}else Dl(e,t)}function It(e,t,n=[]){let l,r=e;if(t.length>1){l=t.shift();const o=typeof l,c=Array.isArray(e);if(Array.isArray(l)){for(let u=0;u<l.length;u++)It(e,[l[u]].concat(t),n);return}else if(c&&o==="function"){for(let u=0;u<e.length;u++)l(e[u],u)&&It(e,[u].concat(t),n);return}else if(c&&o==="object"){const{from:u=0,to:$=e.length-1,by:P=1}=l;for(let p=u;p<=$;p+=P)It(e,[p].concat(t),n);return}else if(t.length>1){It(e[l],t,[l].concat(n));return}r=e[l],n=[l].concat(n)}let i=t[0];typeof i=="function"&&(i=i(r,n),i===r)||l===void 0&&i==null||(i=Gt(i),l===void 0||fn(r)&&fn(i)&&!Array.isArray(i)?Dl(r,i):yn(e,l,i))}function Ui(...[e,t]){const n=Gt(e||{}),l=Array.isArray(n),r=Ll(n);function i(...o){Ql(()=>{l&&o.length===1?Di(n,o[0]):It(n,o)})}return[r,i]}const Ul="ytdl-go:app-state:v1",ji=new Set(["download","library","settings"]),Fi=new Set(["prompt","overwrite","skip","rename"]),zi=new Set(["artists","channels","playlists","all_media"]),Ri=new Set(["gallery","list","detail"]),qn=new Set(["all","audio","video"]),Ki=new Set(["newest","oldest","creator_asc","creator_desc","collection_asc","collection_desc","playlist_asc","playlist_desc"]),Ii=80,an=32,jl=1440*60,st={output:"{title}.{ext}",quality:"best",jobs:1,timeout:180,format:"",audioOnly:!1,onDuplicate:"prompt",useCookies:!0,poTokenExtension:!1},qi={creatorType:"",creatorName:"",albumName:"",playlistKey:"",playlistKind:""},Bi={query:"",creator:"",collection:"",playlist:"",savedPlaylistId:""},Vi=()=>({ui:{activeTab:"download",isAdvanced:!1},settings:{...st},library:{downloads:[],section:"artists",viewMode:"gallery",typeFilter:"all",navPath:{...qi},filters:{...Bi},sortKey:"newest",savedPlaylists:[],playlistAssignments:{},ui:{advancedFiltersOpen:!1,metadataBannerDismissed:!1}},player:{active:!1,selectedMedia:null,minimized:!1},download:{urlInput:"",isDownloading:!1,jobStatus:null,progressTasks:{},logMessages:[],duplicateQueue:[],duplicateError:""}}),Fl=Wl();let Bn=!1;const Gi=e=>({ui:{activeTab:e.ui.activeTab,isAdvanced:e.ui.isAdvanced},settings:{...e.settings},library:{section:e.library.section,viewMode:e.library.viewMode,typeFilter:e.library.typeFilter,navPath:{...e.library.navPath},filters:{query:e.library.filters.query,creator:e.library.filters.creator,collection:e.library.filters.collection,playlist:e.library.filters.playlist,savedPlaylistId:e.library.filters.savedPlaylistId},sortKey:e.library.sortKey,savedPlaylists:e.library.savedPlaylists,playlistAssignments:e.library.playlistAssignments,ui:{advancedFiltersOpen:e.library.ui.advancedFiltersOpen,metadataBannerDismissed:e.library.ui.metadataBannerDismissed}},download:{urlInput:e.download.urlInput}}),$e=(e,t)=>typeof e=="string"?e:t,qt=(e,t)=>typeof e=="boolean"?e:t,Yi=e=>$e(e,"").trim().replace(/\s+/g," ").slice(0,Ii),Vn=(e,t,n)=>{const l=typeof e=="number"?e:Number(e);if(!Number.isFinite(l))return t;const r=Math.trunc(l);return r<=0?t:Math.min(r,n)},Qi=e=>{const t=e&&typeof e=="object"?e:{},n=$e(t.onDuplicate,st.onDuplicate);return{output:$e(t.output,st.output),quality:$e(t.quality,st.quality),jobs:Vn(t.jobs,st.jobs,an),timeout:Vn(t.timeout,st.timeout,jl),format:$e(t.format,st.format),audioOnly:qt(t.audioOnly,st.audioOnly),onDuplicate:Fi.has(n)?n:st.onDuplicate,useCookies:qt(t.useCookies,st.useCookies),poTokenExtension:qt(t.poTokenExtension,st.poTokenExtension)}},Wi=(e,t=new Set)=>{const n=e&&typeof e=="object"?e:{},l=$e(n.savedPlaylistId,"").trim();return{query:$e(n.query,""),creator:$e(n.creator,""),collection:$e(n.collection,""),playlist:$e(n.playlist,""),savedPlaylistId:t.has(l)?l:""}},Xi=e=>{if(!Array.isArray(e))return[];const t=new Set,n=[];for(const l of e){const r=l&&typeof l=="object"?l:{},i=$e(r.id,"").trim(),o=Yi(r.name);i===""||o===""||t.has(i)||(t.add(i),n.push({id:i,name:o,createdAt:$e(r.createdAt,""),updatedAt:$e(r.updatedAt,"")}))}return n},Hi=(e,t)=>{const n=e&&typeof e=="object"?e:{},l={};for(const[r,i]of Object.entries(n)){const o=String(r||"").trim(),c=$e(i,"").trim();o===""||c===""||!t.has(c)||(l[o]=c)}return l},Ji=e=>{const t=e&&typeof e=="object"?e:{},n=$e(t.creatorType,"").trim().toLowerCase(),l=$e(t.playlistKind,"").trim().toLowerCase();return{creatorType:n==="artist"||n==="channel"?n:"",creatorName:$e(t.creatorName,""),albumName:$e(t.albumName,""),playlistKey:$e(t.playlistKey,""),playlistKind:l==="source"||l==="saved"?l:""}},Zi=e=>{const t=e&&typeof e=="object"?e:{};return{advancedFiltersOpen:qt(t.advancedFiltersOpen,!1),metadataBannerDismissed:qt(t.metadataBannerDismissed,!1)}},es=e=>{const t=e&&typeof e=="object"?e:{},n=$e(t.section,"artists"),l=$e(t.viewMode,"gallery"),r=$e(t.sortKey,"newest"),i=Xi(t.savedPlaylists),o=new Set(i.map(P=>P.id)),c=$e(t.typeFilter,"").trim().toLowerCase(),u=$e(t.activeMediaType,"").trim().toLowerCase();let $="all";return qn.has(c)?$=c:qn.has(u)&&($=u),{section:zi.has(n)?n:"artists",viewMode:Ri.has(l)?l:"gallery",typeFilter:$,navPath:Ji(t.navPath),filters:Wi(t.filters,o),sortKey:Ki.has(r)?r:"newest",savedPlaylists:i,playlistAssignments:Hi(t.playlistAssignments,o),ui:Zi(t.ui)}},ts=()=>{if(typeof window>"u")return null;try{const e=window.localStorage.getItem(Ul);return e?JSON.parse(e):null}catch(e){return Bn||(console.warn("Failed to read persisted app state from localStorage:",e),Bn=!0),null}},ns=()=>{var c,u,$;const e=Vi(),t=ts();if(!t||typeof t!="object")return e;const n=ji.has((c=t==null?void 0:t.ui)==null?void 0:c.activeTab)?t.ui.activeTab:e.ui.activeTab,l=typeof((u=t==null?void 0:t.ui)==null?void 0:u.isAdvanced)=="boolean"?t.ui.isAdvanced:e.ui.isAdvanced,r=Qi(t.settings),i=es(t.library),o=typeof(($=t==null?void 0:t.download)==null?void 0:$.urlInput)=="string"?t.download.urlInput:e.download.urlInput;return{...e,ui:{activeTab:n,isAdvanced:l},settings:{...r},library:{...e.library,section:i.section,viewMode:i.viewMode,typeFilter:i.typeFilter,navPath:i.navPath,filters:i.filters,sortKey:i.sortKey,savedPlaylists:i.savedPlaylists,playlistAssignments:i.playlistAssignments,ui:i.ui},download:{...e.download,urlInput:o}}};function ls(e){const[t,n]=Ui(ns());let l=!1;return gt(()=>{if(!(typeof window>"u"))try{window.localStorage.setItem(Ul,JSON.stringify(Gi(t))),l=!1}catch(r){l||(console.warn("Failed to persist app state to localStorage:",r),l=!0)}}),f(Fl.Provider,{value:{state:t,setState:n},get children(){return e.children}})}function zl(){const e=Xl(Fl);if(!e)throw new Error("useAppStore must be used within an AppStoreProvider");return e}const rs=new Set(["queued","running","reconnecting","complete","error"]),is=new Set(["queued","running","reconnecting"]),ss=new Set(["complete","error"]),Rl=e=>{if(typeof e!="string")return"";const t=e.trim().toLowerCase();return rs.has(t)?t:""},as=e=>is.has(e),os=e=>ss.has(e);var cs=C('<div class="text-xs text-gray-500 break-words">'),Gn=C("<div>"),ds=C('<span>Job: <span class="text-gray-400 font-mono">'),us=C("<span>Tasks: <span class=text-gray-400>/"),fs=C("<span>Exit Code: <span class=text-gray-400>"),bs=C('<div class="flex justify-end"><button class="inline-flex items-center gap-2 rounded-xl bg-blue-600 px-3 py-2 text-xs font-bold text-white shadow-lg shadow-blue-600/20 transition-all hover:bg-blue-500">View in Library'),ys=C('<div class="grid grid-cols-3 gap-2"><div class="rounded-xl border border-white/10 bg-white/5 p-3"><div class="text-[10px] uppercase tracking-wider text-gray-500">Total</div><div class="text-sm font-bold text-white"></div></div><div class="rounded-xl border border-white/10 bg-white/5 p-3"><div class="text-[10px] uppercase tracking-wider text-gray-500">Succeeded</div><div class="text-sm font-bold text-green-400"></div></div><div class="rounded-xl border border-white/10 bg-white/5 p-3"><div class="text-[10px] uppercase tracking-wider text-gray-500">Failed</div><div class="text-sm font-bold text-red-400">'),hs=C("<div class=space-y-3>"),gs=C('<div class="max-h-32 overflow-y-auto custom-scrollbar space-y-0.5">'),ms=C('<div><div class="flex items-start gap-3"><div></div><div class="flex-1 min-w-0"><div class="font-bold text-white"></div><div class="mt-2 flex flex-wrap gap-3 text-[11px] text-gray-500">'),ps=C('<div class="space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500"><div class=space-y-2><h1 class="text-4xl font-black text-white">Unlock Content.</h1><p class="text-gray-500 font-medium">Paste your YouTube URLs below to begin high-speed extraction.</p></div><div class="relative group"><textarea class="w-full h-64 bg-[#0a0c14] border-2 border-white/5 rounded-[2rem] p-8 outline-none focus:border-blue-500/50 focus:ring-4 focus:ring-blue-500/10 transition-all text-xl font-medium placeholder:text-gray-800 custom-scrollbar shadow-2xl"placeholder="Enter URLs (one per line)..."></textarea><div class="absolute bottom-6 right-6 flex gap-3"><button class="p-4 bg-white/5 rounded-2xl hover:bg-red-500/10 hover:text-red-400 transition-all"></button><button class="px-8 py-4 bg-blue-600 hover:bg-blue-500 text-white rounded-2xl font-bold flex items-center gap-3 transition-all shadow-xl shadow-blue-600/30 disabled:opacity-50"></button></div></div><div class="grid grid-cols-3 gap-4"><button><div class="p-3 bg-purple-500/10 text-purple-400 rounded-xl w-fit"></div><div class=text-left><div class="font-bold text-white">Audio Only</div><div class="text-xs text-gray-500">Extract high-quality MP3/Opus</div></div></button><div class="relative has-tooltip"><span class="tooltip bg-gray-800 text-[10px] px-3 py-2 rounded-xl shadow-2xl mb-4 border border-white/10 w-56 text-center leading-relaxed">Coming Soon: PO Token Guard runtime controls.</span><button type=button disabled aria-disabled=true aria-label="PO Token Guard (Coming Soon)"class="w-full p-6 rounded-3xl bg-white/5 border border-white/10 flex flex-col gap-3 cursor-not-allowed opacity-70 text-left"><div class="p-3 bg-white/5 text-gray-500 rounded-xl w-fit"></div><div><div class="font-bold text-gray-300">PO Token Guard</div><div class="text-xs text-gray-500">Automated Bot Detection Bypass</div></div></button></div><div class="relative has-tooltip"><span class="tooltip bg-gray-800 text-[10px] px-3 py-2 rounded-xl shadow-2xl mb-4 border border-white/10 w-56 text-center leading-relaxed">Coming Soon: Smart Meta auto-tagging and organization.</span><button type=button disabled aria-disabled=true aria-label="Smart Meta (Coming Soon)"class="w-full p-6 rounded-3xl bg-white/5 border border-white/10 flex flex-col gap-3 cursor-not-allowed opacity-70 text-left"><div class="p-3 bg-white/5 text-gray-500 rounded-xl w-fit"></div><div><div class="font-bold text-gray-300">Smart Meta</div><div class="text-xs text-gray-500">Auto-tagging & Organization'),xs=C('<div class=space-y-1><div class="flex items-center justify-between text-xs"><span class="text-gray-400 truncate flex-1"></span><span class="text-gray-500 ml-2"></span></div><div class="w-full h-1.5 bg-white/5 rounded-full overflow-hidden"><div>'),vs=C('<div class="p-8 bg-[#0a0c14] border border-white/5 rounded-[2rem] space-y-6 animate-in zoom-in-95 duration-300"><h3 class="font-bold text-white flex items-center gap-2">Power User Options</h3><div class="grid grid-cols-2 gap-6"><div class=space-y-2><label class="text-xs font-bold text-gray-500">Output Template</label><input class="w-full bg-[#05070a] border border-white/10 rounded-xl p-3 outline-none focus:border-blue-500 text-gray-300"></div><div class=space-y-2><label class="text-xs font-bold text-gray-500">Concurrent Jobs</label><input type=number min=1 step=1 class="w-full bg-[#05070a] border border-white/10 rounded-xl p-3 outline-none focus:border-blue-500 text-gray-300"></div><div class="space-y-2 col-span-2"><label class="text-xs font-bold text-gray-500">Duplicate Policy</label><select class="w-full bg-[#05070a] border border-white/10 rounded-xl p-3 outline-none focus:border-blue-500 text-gray-300"><option value=prompt>Prompt (default)</option><option value=overwrite>Overwrite</option><option value=skip>Skip</option><option value=rename>Rename');const Yn=[1e3,2e3,4e3,8e3,1e4],Qn=5,Wn=80,ws=new Set(["debug","info","warn","error"]),it=Rl,$s=as,en=os,_s=e=>{switch(e){case"queued":return"Queued";case"running":return"Downloading...";case"reconnecting":return"Reconnecting...";case"complete":return"Download Complete";case"error":return"Download Failed";default:return"Download Status"}},yt=e=>{switch(e){case"queued":return"Waiting for a worker to start the job.";case"running":return"Download in progress...";case"reconnecting":return"Reconnecting to the progress stream...";case"complete":return"All downloads in this job are finished.";case"error":return"Download failed.";default:return""}},Ss=e=>e==="complete"?"check-circle-2":e==="error"?"alert-circle":"loader",ks=e=>e==="error"?{card:"bg-red-500/5 border-red-500/20",icon:"bg-red-500/10 text-red-400",accent:"text-red-400"}:e==="complete"?{card:"bg-green-500/5 border-green-500/20",icon:"bg-green-500/10 text-green-400",accent:"text-green-400"}:e==="reconnecting"?{card:"bg-amber-500/5 border-amber-500/20",icon:"bg-amber-500/10 text-amber-400",accent:"text-amber-400"}:{card:"bg-blue-500/5 border-blue-500/20",icon:"bg-blue-500/10 text-blue-400",accent:"text-blue-400"},wn=(e,t,n)=>{const l=typeof e=="number"?e:Number(e);if(!Number.isFinite(l))return t;const r=Math.trunc(l);return r<=0?t:Math.min(r,n)},He=(e,t=0)=>{const n=typeof e=="number"?e:Number(e);return Number.isFinite(n)?Math.max(0,Math.trunc(n)):t},Et=e=>{const t=typeof e=="number"?e:Number(e);return!Number.isFinite(t)||t<0?0:t>100?100:t},tn=e=>{if(!e||typeof e!="object")return null;const t={total:He(e.total,0),succeeded:He(e.succeeded,0),failed:He(e.failed,0)};return t.total<=0&&t.succeeded<=0&&t.failed<=0?null:t},Xn=e=>{const t=He(e,0);if(t<=0)return"0 B";const n=["B","KB","MB","GB","TB"],l=Math.min(Math.floor(Math.log(t)/Math.log(1024)),n.length-1),r=t/1024**l,i=l===0?0:1;return`${r.toFixed(i)} ${n[l]}`},Cs=(e,t)=>t?"100%":`${Et(e).toFixed(1)}%`,nn=(e,t,n)=>{const l=typeof t=="string"?t.trim():"";if(l!==""&&l!==e)return l;if(e==="error"){const r=typeof n=="string"?n.trim():"";if(r)return r}return yt(e)},Hn=e=>{if(typeof e!="string")return"info";const t=e.trim().toLowerCase();return ws.has(t)?t:"info"},$n=(e,t,n)=>t??(e==="complete"?0:e==="error"?n??null:null);function Ps(e={}){const{state:t,setState:n}=zl(),l=()=>t.download.urlInput,r=s=>{n("download","urlInput",s)},i=()=>t.download.isDownloading,o=s=>{n("download","isDownloading",s)},c=()=>t.download.jobStatus,u=s=>{n("download","jobStatus",y=>typeof s=="function"?s(y):s)},$=()=>t.download.progressTasks,P=s=>{n("download","progressTasks",y=>typeof s=="function"?s(y):s)},p=()=>t.download.logMessages,j=s=>{n("download","logMessages",y=>typeof s=="function"?s(y):s)},J=()=>t.download.duplicateQueue,le=s=>{n("download","duplicateQueue",y=>typeof s=="function"?s(y):s)},re=()=>t.download.duplicateError,V=s=>{n("download","duplicateError",s)},se=()=>t.settings,_e=()=>t.ui.isAdvanced,fe=s=>{if(typeof s=="function"){n("settings",y=>{const g=s(y);return!g||typeof g!="object"?y:{...y,...g}});return}!s||typeof s!="object"||n("settings",y=>({...y,...s}))};let F=null,Pe=null,Se=0,Te="",Be=0;const Ve=()=>J()[0],ke=()=>Object.entries($()).sort(([,s],[,y])=>{const g=((s==null?void 0:s.label)||"").toLowerCase(),S=((y==null?void 0:y.label)||"").toLowerCase();return g===S?0:g<S?-1:1}),Me=()=>{const s=ke();let y=0;for(const[,g]of s)(g!=null&&g.done||Et(g==null?void 0:g.percent)>=100)&&(y+=1);return{total:s.length,done:y}},tt=()=>{var s;return tn((s=c())==null?void 0:s.stats)},Ee=()=>{var s;return it((s=c())==null?void 0:s.status)},Le=()=>{var s;return ks(it((s=c())==null?void 0:s.status))},Ae=()=>{var s,y;return Ee()==="complete"?!0:Ee()!=="error"?!1:He((y=(s=c())==null?void 0:s.stats)==null?void 0:y.succeeded,0)>0},ot=()=>{typeof e.onOpenLibrary=="function"&&e.onOpenLibrary()},Fe=()=>{F&&(F.close(),F=null)},ct=()=>{Pe&&(clearTimeout(Pe),Pe=null)},Je=()=>{ct(),Fe(),Se=0,Te="",Be=0},Ge=s=>{const y=s.split(`
`).map(b=>b.trim()).filter(Boolean),g=[],S=[];for(const b of y){try{const M=new URL(b);if(M.protocol==="http:"||M.protocol==="https:"){g.push(b);continue}}catch{}S.push(b)}return{validUrls:g,invalidUrls:S}},ze=s=>{s&&le(y=>y.filter(g=>g.promptId!==s))},pt=()=>{Se=0,ct(),u(s=>!s||s.status!=="reconnecting"?s:{...s,status:"running",message:yt("running"),error:""})},xt=(s,y)=>{if(!s||typeof s!="object")return;const g=typeof s.jobId=="string"&&s.jobId?s.jobId:y;if(g!==y)return;const S={};if(Array.isArray(s.tasks))for(const d of s.tasks){if(!d||typeof d!="object"||typeof d.id!="string"||d.id==="")continue;const h=He(d.total,0),A=He(d.current,0),x=Et(d.percent),ce=!!d.done||x>=100;S[d.id]={label:d.label||d.id,total:h,current:h>0&&A>h?h:A,percent:ce?100:x,done:ce}}P(S);const b=[];if(Array.isArray(s.logs))for(const d of s.logs.slice(-Wn))!d||typeof d!="object"||typeof d.message!="string"||d.message===""||b.push({level:Hn(d.level),message:d.message});j(b);const M=[];if(Array.isArray(s.duplicates))for(const d of s.duplicates)!d||typeof d!="object"||typeof d.promptId!="string"||d.promptId===""||M.push({jobId:g,promptId:d.promptId,path:typeof d.path=="string"?d.path:"",filename:typeof d.filename=="string"?d.filename:""});le(M),V("");const w=it(s.status),I=tn(s.stats),Q=typeof s.error=="string"?s.error:"",oe=Number.isFinite(Number(s.exitCode))?Math.trunc(Number(s.exitCode)):null,ge=Number(s.lastSeq);if(Number.isFinite(ge)&&ge>Be&&(Be=Math.trunc(ge)),u(d=>{const h=w||it(d==null?void 0:d.status)||"running";return{...d||{},jobId:g,status:h,message:nn(h,"",Q),error:h==="error"?Q||(d==null?void 0:d.error)||yt("error"):"",exitCode:$n(h,oe,d==null?void 0:d.exitCode),stats:I||(d==null?void 0:d.stats)||null}}),w&&en(w)){o(!1);return}o(!0)},v=(s,y)=>{const g=it((s==null?void 0:s.status)||(s==null?void 0:s.message));if(!g)return;const S=typeof s.error=="string"?s.error:"",b=tn(s.stats),M=Number.isFinite(Number(s.exitCode))?Math.trunc(Number(s.exitCode)):null;if(u(w=>({...w||{},jobId:y,status:g,message:nn(g,s.message,S),error:g==="error"?S||(w==null?void 0:w.error)||yt("error"):"",exitCode:$n(g,M,w==null?void 0:w.exitCode),stats:b||(w==null?void 0:w.stats)||null})),en(g)){o(!1),le([]),V("");return}o(!0)},W=(s,y)=>{const g=it((s==null?void 0:s.status)||(s==null?void 0:s.message))||"complete",S=typeof s.error=="string"?s.error:"",b=tn(s.stats),M=Number.isFinite(Number(s.exitCode))?Math.trunc(Number(s.exitCode)):null;u(w=>({...w||{},jobId:y,status:g,message:nn(g,s.message,S),error:g==="error"?S||(w==null?void 0:w.error)||yt("error"):"",exitCode:$n(g,M,w==null?void 0:w.exitCode),stats:b||(w==null?void 0:w.stats)||null})),o(!1),le([]),V(""),Je()},Z=async s=>{const y=Ve();if(y){V("");try{const g=await fetch("/api/download/duplicate-response",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jobId:y.jobId,promptId:y.promptId,choice:s})}),S=await g.json().catch(()=>({}));if(!g.ok||S.error){if(g.status===404||g.status===409){ze(y.promptId),V("");return}V(S.error||"Failed to submit duplicate choice");return}ze(y.promptId),V("")}catch(g){V(g.message||"Failed to submit duplicate choice")}}},De=s=>{if(Ve()&&!(s.metaKey||s.ctrlKey||s.altKey))switch(s.key){case"o":s.preventDefault(),Z("overwrite");break;case"O":s.preventDefault(),Z("overwrite_all");break;case"s":s.preventDefault(),Z("skip");break;case"S":s.preventDefault(),Z("skip_all");break;case"r":s.preventDefault(),Z("rename");break;case"R":s.preventDefault(),Z("rename_all");break;case"q":s.preventDefault(),Z("cancel");break}};wl(()=>{typeof window<"u"&&window.addEventListener("keydown",De)}),gn(()=>{Je(),typeof window<"u"&&window.removeEventListener("keydown",De)});const Oe=s=>{Je(),Te=s;const y=()=>{if(Te!==s)return;ct(),Fe();const g=new URLSearchParams({id:s});Be>0&&g.set("since",String(Be)),F=new EventSource(`/api/download/progress?${g.toString()}`),F.onmessage=S=>{if(Te===s)try{const b=JSON.parse(S.data);if(!b||typeof b!="object"||typeof b.type!="string"||(typeof b.jobId=="string"&&b.jobId?b.jobId:s)!==s)return;if(b.type!=="snapshot"){const w=Number(b.seq);if(Number.isFinite(w)&&w>0){const I=Math.trunc(w);if(I<=Be)return;Be=I}}switch(pt(),b.type){case"snapshot":xt(b.snapshot,s);break;case"status":v(b,s);break;case"register":typeof b.id=="string"&&b.id!==""&&P(w=>{var I,Q;return{...w,[b.id]:{...w[b.id]||{},label:b.label||((I=w[b.id])==null?void 0:I.label)||b.id,total:He(b.total,((Q=w[b.id])==null?void 0:Q.total)||0),current:He(b.current,0),percent:Et(b.percent),done:!1}}});break;case"progress":typeof b.id=="string"&&b.id!==""&&P(w=>{const I=w[b.id]||{},Q=He(b.total,I.total||0);let oe=He(b.current,I.current||0);Q>0&&oe>Q&&(oe=Q);const ge=Et(typeof b.percent=="number"&&Number.isFinite(b.percent)?b.percent:Q>0?oe*100/Q:I.percent||0);return{...w,[b.id]:{...I,label:b.label||I.label||b.id,total:Q,current:oe,percent:ge,done:ge>=100}}});break;case"finish":typeof b.id=="string"&&b.id!==""&&P(w=>{var I,Q,oe,ge;return{...w,[b.id]:{...w[b.id]||{},label:((I=w[b.id])==null?void 0:I.label)||b.id,current:Math.max(He((Q=w[b.id])==null?void 0:Q.current,0),He((oe=w[b.id])==null?void 0:oe.total,0)),total:He((ge=w[b.id])==null?void 0:ge.total,0),percent:100,done:!0}}});break;case"log":typeof b.message=="string"&&b.message!==""&&j(w=>[...w,{level:Hn(b.level),message:b.message}].slice(-Wn));break;case"duplicate":typeof b.promptId=="string"&&b.promptId!==""&&(le(w=>w.some(I=>I.promptId===b.promptId)?w:[...w,{jobId:s,promptId:b.promptId,path:typeof b.path=="string"?b.path:"",filename:typeof b.filename=="string"?b.filename:""}]),V(""));break;case"duplicate-resolved":typeof b.promptId=="string"&&b.promptId!==""&&(ze(b.promptId),V(""));break;case"done":W(b,s);break;default:break}}catch{}},F.onerror=()=>{var M;if(Te!==s)return;Fe(),ct();const S=it((M=c())==null?void 0:M.status);if(!$s(S))return;if(Se>=Qn){Je(),u(w=>({...w||{jobId:s},jobId:s,status:"error",message:"Progress stream disconnected.",error:"Connection lost. Progress updates stopped before completion."})),o(!1),le([]),V("");return}Se+=1;const b=Yn[Math.min(Se-1,Yn.length-1)];u(w=>({...w||{jobId:s},jobId:s,status:"reconnecting",message:`Reconnecting... (${Se}/${Qn})`,error:""})),Pe=setTimeout(()=>{Pe=null,Te===s&&y()},b)}};y()},K=async()=>{if(!l().trim())return;Je(),o(!0),u(null),P({}),j([]),le([]),V("");const{validUrls:s,invalidUrls:y}=Ge(l());if(y.length>0){const b=y.slice(0,3).join(", "),M=y.length>3?", ...":"",w=y.length===1?"Invalid URL":`Invalid URLs (${y.length})`;u({status:"error",message:yt("error"),error:`${w}: ${b}${M}`}),o(!1);return}if(s.length===0){u({status:"error",message:yt("error"),error:"No valid URLs provided."}),o(!1);return}const g=se(),S={urls:s,options:{output:g.output,audio:g.audioOnly,quality:g.quality,format:g.format,jobs:wn(g.jobs,1,an),timeout:wn(g.timeout,180,jl),"on-duplicate":g.onDuplicate||"prompt"}};try{const b=await fetch("/api/download",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)}),M=await b.json().catch(()=>({}));if(!b.ok||M.error||typeof M.jobId!="string"||M.jobId===""){u({status:"error",message:yt("error"),error:M.error||"Failed to start download job."}),o(!1);return}u({status:"queued",jobId:M.jobId,message:nn("queued",M.message,""),error:"",exitCode:null,stats:null}),Oe(M.jobId)}catch(b){u({status:"error",message:yt("error"),error:b.message||"Failed to start download job."}),o(!1)}};return(()=>{var s=ps(),y=s.firstChild,g=y.nextSibling,S=g.firstChild,b=S.nextSibling,M=b.firstChild,w=M.nextSibling,I=g.nextSibling,Q=I.firstChild,oe=Q.firstChild,ge=Q.nextSibling,d=ge.firstChild,h=d.nextSibling,A=h.firstChild,x=ge.nextSibling,ce=x.firstChild,Ue=ce.nextSibling,je=Ue.firstChild;return S.$$input=me=>r(me.target.value),M.$$click=()=>r(""),a(M,f(ie,{name:"trash-2",class:"w-6 h-6"})),w.$$click=K,a(w,f(ie,{name:"download-cloud",class:"w-6 h-6"}),null),a(w,()=>i()?"Processing...":"Start Extraction",null),Q.$$click=()=>fe({...se(),audioOnly:!se().audioOnly}),a(oe,f(ie,{name:"music",class:"w-5 h-5"})),a(A,f(ie,{name:"shield-check",class:"w-5 h-5"})),a(je,f(ie,{name:"database",class:"w-5 h-5"})),a(s,f(L,{get when(){return c()},get children(){var me=ms(),nt=me.firstChild,Ye=nt.firstChild,dt=Ye.nextSibling,ut=dt.firstChild,Qe=ut.nextSibling;return a(Ye,f(ie,{get name(){var E;return Ss(it((E=c())==null?void 0:E.status))},get class(){var E;return`w-5 h-5 ${en(it((E=c())==null?void 0:E.status))?"":"animate-spin"}`}})),a(ut,()=>{var E;return _s(it((E=c())==null?void 0:E.status))}),a(dt,f(L,{get when(){var E;return(E=c())==null?void 0:E.message},get children(){var E=cs();return a(E,()=>c().message),E}}),Qe),a(dt,f(L,{get when(){var E;return et(()=>{var ee;return((ee=c())==null?void 0:ee.status)==="error"})()&&((E=c())==null?void 0:E.error)},get children(){var E=Gn();return a(E,()=>c().error),U(()=>pe(E,`text-xs break-words ${Le().accent}`)),E}}),Qe),a(Qe,f(L,{get when(){var E;return(E=c())==null?void 0:E.jobId},get children(){var E=ds(),ee=E.firstChild,B=ee.nextSibling;return a(B,()=>c().jobId),E}}),null),a(Qe,f(L,{get when(){return Me().total>0},get children(){var E=us(),ee=E.firstChild,B=ee.nextSibling,ae=B.firstChild;return a(B,()=>Me().done,ae),a(B,()=>Me().total,null),E}}),null),a(Qe,f(L,{get when(){var E;return et(()=>{var ee;return!!en(it((ee=c())==null?void 0:ee.status))})()&&((E=c())==null?void 0:E.exitCode)!=null},get children(){var E=fs(),ee=E.firstChild,B=ee.nextSibling;return a(B,()=>c().exitCode),E}}),null),a(me,f(L,{get when(){return et(()=>!!Ae())()&&typeof e.onOpenLibrary=="function"},get children(){var E=bs(),ee=E.firstChild,B=ee.firstChild;return ee.$$click=ot,a(ee,f(ie,{name:"layers",class:"w-4 h-4"}),B),E}}),null),a(me,f(L,{get when(){return tt()},get children(){var E=ys(),ee=E.firstChild,B=ee.firstChild,ae=B.nextSibling,de=ee.nextSibling,Re=de.firstChild,k=Re.nextSibling,m=de.nextSibling,D=m.firstChild,N=D.nextSibling;return a(ae,()=>tt().total),a(k,()=>tt().succeeded),a(N,()=>tt().failed),E}}),null),a(me,f(L,{get when(){return ke().length>0},get children(){var E=hs();return a(E,f(ye,{get each(){return ke()},children:([ee,B])=>{const ae=Et(B==null?void 0:B.percent);return(()=>{var de=xs(),Re=de.firstChild,k=Re.firstChild,m=k.nextSibling,D=Re.nextSibling,N=D.firstChild;return a(k,()=>(B==null?void 0:B.label)||ee),a(m,()=>Cs(ae,!!(B!=null&&B.done)),null),a(m,(()=>{var _=et(()=>(B==null?void 0:B.total)>0);return()=>_()?`  ${Xn(B.current)} / ${Xn(B.total)}`:""})(),null),U(_=>{var X=`h-full rounded-full transition-all duration-300 ${B!=null&&B.done?"bg-green-500":"bg-blue-500"}`,O=`${Math.min(100,ae)}%`;return X!==_.e&&pe(N,_.e=X),O!==_.t&&wr(N,"width",_.t=O),_},{e:void 0,t:void 0}),de})()}})),E}}),null),a(me,f(L,{get when(){return p().length>0},get children(){var E=gs();return a(E,f(ye,{get each(){return p()},children:ee=>(()=>{var B=Gn();return a(B,()=>ee.message),U(()=>pe(B,`text-[11px] font-mono px-2 py-0.5 rounded break-words ${ee.level==="error"?"text-red-400":ee.level==="warn"?"text-amber-400":"text-gray-500"}`)),B})()})),E}}),null),U(E=>{var ee=`p-6 rounded-3xl border-2 space-y-4 animate-in fade-in duration-300 ${Le().card}`,B=`p-2 rounded-xl ${Le().icon}`;return ee!==E.e&&pe(me,E.e=ee),B!==E.t&&pe(Ye,E.t=B),E},{e:void 0,t:void 0}),me}}),null),a(s,(()=>{var me=et(()=>!!_e());return()=>me()&&(()=>{var nt=vs(),Ye=nt.firstChild,dt=Ye.firstChild,ut=Ye.nextSibling,Qe=ut.firstChild,E=Qe.firstChild,ee=E.nextSibling,B=Qe.nextSibling,ae=B.firstChild,de=ae.nextSibling,Re=B.nextSibling,k=Re.firstChild,m=k.nextSibling;return a(Ye,f(ie,{name:"terminal",class:"w-4 h-4 text-blue-400"}),dt),ee.$$input=D=>fe({...se(),output:D.target.value}),de.$$input=D=>fe({...se(),jobs:wn(D.target.value,1,an)}),be(de,"max",an),m.addEventListener("change",D=>fe({...se(),onDuplicate:D.target.value})),U(()=>ee.value=se().output),U(()=>de.value=se().jobs),U(()=>m.value=se().onDuplicate||"prompt"),nt})()})(),null),a(s,f(L,{get when(){return Ve()},get children(){return f(Mi,{get prompt(){return Ve()},get error(){return re()},onSelect:Z})}}),null),U(me=>{var nt=i(),Ye=`p-6 rounded-3xl border-2 transition-all flex flex-col gap-3 ${se().audioOnly?"bg-blue-600/10 border-blue-500/50":"bg-white/5 border-transparent hover:border-white/10"}`;return nt!==me.e&&(w.disabled=me.e=nt),Ye!==me.t&&pe(Q,me.t=Ye),me},{e:void 0,t:void 0}),U(()=>S.value=l()),s})()}jt(["input","click"]);const Jn="Unknown Artist",Zn="Unknown Channel",As="Unknown Album",Kl="Standalone",Ze=(...e)=>{for(const t of e)if(typeof t=="string"){const n=t.trim();if(n!=="")return n}return""},Ns=e=>{const t=String(e||"").toLowerCase();return t==="audio"?"audio":"video"},Ts=e=>e!=null&&e.metadata&&typeof e.metadata=="object"?e.metadata:{},Ms=e=>{if(typeof(e==null?void 0:e.modified_at)=="string"){const t=Date.parse(e.modified_at);if(Number.isFinite(t))return t}if(typeof(e==null?void 0:e.modifiedAt)=="string"){const t=Date.parse(e.modifiedAt);if(Number.isFinite(t))return t}if(typeof(e==null?void 0:e.date)=="string"){const t=Date.parse(e.date);if(Number.isFinite(t))return t}return 0},Ke=(e,t)=>String(e||"").localeCompare(String(t||""),void 0,{sensitivity:"base",numeric:!0}),Qt=(e,t)=>e!==""?e:t||"",Es=(e,t,n)=>{var V,se;const l=Ts(e),r=Ns(e==null?void 0:e.type),i=Ze(e==null?void 0:e.title,l.title,"Untitled"),o=Ze(e==null?void 0:e.artist,l.artist,l.author,r==="audio"?Jn:Zn),c=Ze(e==null?void 0:e.album,l.album,r==="audio"?As:o),u=Ze((V=e==null?void 0:e.playlist)==null?void 0:V.title,(se=l==null?void 0:l.playlist)==null?void 0:se.title,Kl),$=Ze(e==null?void 0:e.thumbnail_url,e==null?void 0:e.thumbnailUrl,e==null?void 0:e.thumbnailURL,l.thumbnail_url,l.thumbnailUrl,l.thumbnailURL),P=Ze(e==null?void 0:e.relative_path,e==null?void 0:e.filename,e==null?void 0:e.id),p=Ze(n[P],""),j=t.get(p),J=Ms(e),le=!!((e==null?void 0:e.has_sidecar)??(e==null?void 0:e.hasSidecar)),re=[];return le||re.push("missing_sidecar"),(o===Jn||o===Zn)&&re.push("missing_creator"),i==="Untitled"&&re.push("missing_title"),{raw:e,mediaKey:P,filename:String((e==null?void 0:e.filename)||""),relativePath:Ze(e==null?void 0:e.relative_path,e==null?void 0:e.filename,""),folder:String((e==null?void 0:e.folder)||""),id:String((e==null?void 0:e.id)||(e==null?void 0:e.filename)||P),type:r,title:i,creator:o,album:c,sourcePlaylist:u,savedPlaylistId:(j==null?void 0:j.id)||"",savedPlaylistName:(j==null?void 0:j.name)||"Unassigned",date:Ze(e==null?void 0:e.date,""),modifiedAt:Ze(e==null?void 0:e.modified_at,e==null?void 0:e.modifiedAt,""),size:Ze(e==null?void 0:e.size,""),sizeBytes:Number.isFinite(Number(e==null?void 0:e.size_bytes))?Number(e.size_bytes):0,sourceURL:Ze(e==null?void 0:e.source_url,l.source_url,""),thumbnailUrl:$,metadata:l,timestamp:J,hasSidecar:le,anomalies:re,hasAnomaly:re.length>0}},Dt=(e,t)=>{const n=[...e];return n.sort((l,r)=>{switch(t){case"oldest":return l.timestamp-r.timestamp||Ke(l.title,r.title);case"creator_asc":return Ke(l.creator,r.creator)||Ke(l.title,r.title);case"creator_desc":return Ke(r.creator,l.creator)||Ke(l.title,r.title);case"collection_asc":return Ke(l.album,r.album)||Ke(l.title,r.title);case"collection_desc":return Ke(r.album,l.album)||Ke(l.title,r.title);case"playlist_asc":return Ke(l.sourcePlaylist,r.sourcePlaylist)||Ke(l.title,r.title);case"playlist_desc":return Ke(r.sourcePlaylist,l.sourcePlaylist)||Ke(l.title,r.title);case"newest":default:return r.timestamp-l.timestamp||Ke(l.title,r.title)}}),n},Ls=(e,t)=>{const n=String(t.query||"").trim().toLowerCase();return!(n&&![e.title,e.creator,e.album,e.sourcePlaylist,e.savedPlaylistName,e.filename].join(" ").toLowerCase().includes(n)||t.creator&&e.creator!==t.creator||t.collection&&e.album!==t.collection||t.playlist&&e.sourcePlaylist!==t.playlist||t.savedPlaylistId&&e.savedPlaylistId!==t.savedPlaylistId)},kt=e=>[...e].sort((t,n)=>n.latestTimestamp-t.latestTimestamp||Ke(t.name,n.name)),Os=e=>{const t=new Map;for(const r of e.filter(i=>i.type==="audio")){t.has(r.creator)||t.set(r.creator,{name:r.creator,type:"artist",items:[],albumsByName:new Map,latestTimestamp:r.timestamp,thumbnailUrl:r.thumbnailUrl||""});const i=t.get(r.creator);i.items.push(r),i.latestTimestamp=Math.max(i.latestTimestamp,r.timestamp),i.thumbnailUrl=Qt(i.thumbnailUrl,r.thumbnailUrl),i.albumsByName.has(r.album)||i.albumsByName.set(r.album,{name:r.album,items:[],latestTimestamp:r.timestamp,thumbnailUrl:r.thumbnailUrl||""});const o=i.albumsByName.get(r.album);o.items.push(r),o.latestTimestamp=Math.max(o.latestTimestamp,r.timestamp),o.thumbnailUrl=Qt(o.thumbnailUrl,r.thumbnailUrl)}const n=[],l=new Map;for(const[r,i]of t.entries()){const o=kt(Array.from(i.albumsByName.values())).map(u=>({...u,items:Dt(u.items,"newest"),count:u.items.length})),c={name:r,type:"artist",items:Dt(i.items,"newest"),count:i.items.length,latestTimestamp:i.latestTimestamp,thumbnailUrl:i.thumbnailUrl,albums:o};n.push(c),l.set(r,c)}return{groups:kt(n),byName:l}},Ds=e=>{const t=new Map;for(const r of e.filter(i=>i.type==="video")){t.has(r.creator)||t.set(r.creator,{name:r.creator,type:"channel",items:[],latestTimestamp:r.timestamp,thumbnailUrl:r.thumbnailUrl||""});const i=t.get(r.creator);i.items.push(r),i.latestTimestamp=Math.max(i.latestTimestamp,r.timestamp),i.thumbnailUrl=Qt(i.thumbnailUrl,r.thumbnailUrl)}const n=[],l=new Map;for(const[r,i]of t.entries()){const o={name:r,type:"channel",items:Dt(i.items,"newest"),count:i.items.length,latestTimestamp:i.latestTimestamp,thumbnailUrl:i.thumbnailUrl};n.push(o),l.set(r,o)}return{groups:kt(n),byName:l}},Us=(e,t)=>{const n=new Map;for(const u of e){const $=Ze(u.sourcePlaylist,Kl),P=`source:${$.toLowerCase()}`;n.has(P)||n.set(P,{key:P,kind:"source",name:$,items:[],latestTimestamp:u.timestamp,thumbnailUrl:u.thumbnailUrl||""});const p=n.get(P);p.items.push(u),p.latestTimestamp=Math.max(p.latestTimestamp,u.timestamp),p.thumbnailUrl=Qt(p.thumbnailUrl,u.thumbnailUrl)}const l=new Map;for(const u of t)l.set(u.id,{key:`saved:${u.id}`,kind:"saved",name:u.name,playlistId:u.id,items:[],latestTimestamp:0,thumbnailUrl:""});for(const u of e){if(!u.savedPlaylistId||!l.has(u.savedPlaylistId))continue;const $=l.get(u.savedPlaylistId);$.items.push(u),$.latestTimestamp=Math.max($.latestTimestamp,u.timestamp),$.thumbnailUrl=Qt($.thumbnailUrl,u.thumbnailUrl)}const r=kt(Array.from(n.values())).map(u=>({...u,count:u.items.length,items:Dt(u.items,"newest")})),i=kt(Array.from(l.values())).map(u=>({...u,count:u.items.length,items:Dt(u.items,"newest")})),o=kt([...r,...i]),c=new Map(o.map(u=>[u.key,u]));return{sourceGroups:r,savedGroups:i,combined:o,byKey:c}},_n=e=>Array.from(new Set(e.filter(t=>typeof t=="string"&&t.trim()!=="").map(t=>t.trim()))).sort(Ke),js=({downloads:e,savedPlaylists:t,playlistAssignments:n,typeFilter:l,sortKey:r,filters:i})=>{const o=Array.isArray(e)?e:[],c=Array.isArray(t)?t:[],u=n&&typeof n=="object"?n:{},$=new Map(c.map(F=>[String(F.id||"").trim(),F])),P=o.map(F=>Es(F,$,u)),p=P.filter(F=>F.hasAnomaly),J=P.filter(F=>l==="all"?!0:F.type===l).filter(F=>Ls(F,i||{})),le=Dt(J,r),re=Os(J),V=Ds(J),se=Us(J,c),_e=kt([...re.groups.map(F=>({...F,key:`artist:${F.name}`,creatorType:"artist"})),...V.groups.map(F=>({...F,key:`channel:${F.name}`,creatorType:"channel"}))]),fe={creators:_n(J.map(F=>F.creator)),collections:_n(J.map(F=>F.album)),sourcePlaylists:_n(J.map(F=>F.sourcePlaylist))};return{items:P,filteredItems:le,anomalyItems:p,anomalyCount:p.length,artists:re.groups,artistsByName:re.byName,channels:V.groups,channelsByName:V.byName,creatorCards:_e,playlists:se.combined,playlistsByKey:se.byKey,sourcePlaylists:se.sourceGroups,savedPlaylists:se.savedGroups,filterOptions:fe}};var Fs=C('<div class="mt-2 text-xs text-amber-100/80">'),zs=C('<div class="rounded-2xl border border-amber-300/30 bg-amber-500/10 p-4 text-sm text-amber-100"><div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between"><div><div class=font-semibold> item<!> missing expected metadata coverage.</div><div class="text-xs text-amber-100/80">Unknown buckets remain visible for transparency. Retry scan, then re-download legacy files without sidecars if needed.</div></div><div class="flex items-center gap-2"><button type=button class="rounded-lg border border-amber-200/40 bg-amber-300/10 px-3 py-1.5 text-xs font-semibold text-amber-100 hover:bg-amber-300/20 transition-colors">Retry metadata</button><button type=button class="rounded-lg border border-white/20 px-3 py-1.5 text-xs font-semibold text-slate-200 hover:bg-white/10 transition-colors">Dismiss'),Rs=C('<button type=button class="rounded-xl border border-cyan-400/30 bg-cyan-500/10 px-3 py-2 text-xs font-semibold text-cyan-100 hover:bg-cyan-500/20 transition-colors">Manage Saved Playlists'),Ks=C('<div class="grid gap-3 rounded-2xl border border-white/10 bg-black/20 p-4 md:grid-cols-2 xl:grid-cols-5"><label class="space-y-1 text-[11px] font-semibold uppercase tracking-wide text-slate-400">Search<input type=text placeholder="Title, creator, album"class="w-full rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-500/40 normal-case"></label><label class="space-y-1 text-[11px] font-semibold uppercase tracking-wide text-slate-400">Creator<select class="w-full rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-500/40 normal-case"><option value>All creators</option></select></label><label class="space-y-1 text-[11px] font-semibold uppercase tracking-wide text-slate-400">Collection<select class="w-full rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-500/40 normal-case"><option value>All collections</option></select></label><label class="space-y-1 text-[11px] font-semibold uppercase tracking-wide text-slate-400">Source Playlist<select class="w-full rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-500/40 normal-case"><option value>All source playlists</option></select></label><label class="space-y-1 text-[11px] font-semibold uppercase tracking-wide text-slate-400">Saved Playlist<select class="w-full rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-500/40 normal-case"><option value>All saved playlists'),Is=C('<button type=button class="rounded-lg border border-red-300/40 px-2 py-1 font-semibold text-red-100 hover:bg-red-500/20 transition-colors">Retry'),qs=C('<div class="flex flex-wrap items-center justify-between gap-2 rounded-2xl border border-red-400/30 bg-red-500/10 px-4 py-3 text-xs text-red-100"><span>'),Bs=C('<div class="flex flex-wrap items-center gap-2 text-xs">'),Vs=C('<div><div class="mb-3 text-xs font-semibold uppercase tracking-[0.12em] text-cyan-200/80">Artists</div><div class="grid gap-4 sm:grid-cols-2 xl:grid-cols-4">'),Gs=C('<div><div class="mb-3 text-xs font-semibold uppercase tracking-[0.12em] text-cyan-200/80">Channels</div><div class="grid gap-4 sm:grid-cols-2 xl:grid-cols-4">'),Ys=C("<div class=space-y-6>"),Qs=C('<div class="overflow-x-auto rounded-2xl border border-white/10 bg-black/20"><table class="w-full min-w-[980px] text-sm"><thead class="bg-white/5 text-xs uppercase tracking-wide text-slate-400"><tr><th class="px-4 py-3 text-left">Media</th><th class="px-4 py-3 text-left">Creator</th><th class="px-4 py-3 text-left">Collection</th><th class="px-4 py-3 text-left">Playlists</th><th class="px-4 py-3 text-left">Type</th><th class="px-4 py-3 text-left">Date</th><th class="px-4 py-3 text-left">Saved Assignment</th><th class="px-4 py-3 text-right">Action</th></tr></thead><tbody>'),Ws=C('<div class="overflow-hidden rounded-2xl border border-white/10 bg-black/20"><table class="w-full text-sm"><thead class="bg-white/5 text-xs uppercase tracking-wide text-slate-400"><tr><th class="px-4 py-3 text-left">Title</th><th class="px-4 py-3 text-left">Creator</th><th class="px-4 py-3 text-left">Collection</th><th class="px-4 py-3 text-left">Type</th></tr></thead><tbody>'),Xs=C('<div class="grid gap-4 lg:grid-cols-[1fr_320px]"><aside class="rounded-2xl border border-white/10 bg-black/20 p-4">'),Hs=C("<div>"),Js=C('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4"><div class="w-full max-w-xl rounded-2xl border border-white/10 bg-[#0b0f16] p-5 shadow-2xl"><div class="flex items-center justify-between"><h3 class="text-lg font-bold text-white">Manage Saved Playlists</h3><button type=button class="rounded-lg border border-white/15 bg-white/5 p-2 text-slate-300 hover:bg-white/10 transition-colors"></button></div><div class="mt-4 flex gap-2"><input type=text placeholder="New saved playlist name"class="w-full rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-500/40"><button type=button class="rounded-xl bg-cyan-500 px-4 py-2 text-sm font-semibold text-slate-950 hover:bg-cyan-400 transition-colors">Create</button></div><div class="mt-4 max-h-80 space-y-2 overflow-y-auto pr-1">'),Zs=C('<div class="space-y-6 animate-in fade-in slide-in-from-right-4 duration-500"><div class="relative overflow-hidden rounded-3xl border border-cyan-500/10 bg-[radial-gradient(circle_at_20%_20%,rgba(56,189,248,0.12),transparent_52%),radial-gradient(circle_at_80%_0%,rgba(20,184,166,0.1),transparent_40%),linear-gradient(180deg,#090c12,#070a10)] p-6 shadow-[0_0_0_1px_rgba(15,23,42,0.45),0_20px_80px_rgba(6,10,18,0.6)]"><div class="flex flex-col gap-6 lg:flex-row lg:items-start"><aside class="w-full lg:w-56 shrink-0 rounded-2xl border border-white/10 bg-black/20 p-3"><div class="text-[10px] font-semibold uppercase tracking-[0.14em] text-cyan-200/80">Library Sections</div><div class="mt-2 space-y-1"></div></aside><div class="min-w-0 flex-1 space-y-4"><div class="flex flex-col gap-2 md:flex-row md:items-end md:justify-between"><div><h1 class="text-3xl font-black tracking-tight text-white">Your Library</h1><p class="text-sm text-slate-400"></p></div><div class="rounded-full border border-cyan-500/20 bg-cyan-500/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.12em] text-cyan-100"></div></div><div class="flex flex-wrap items-center gap-2 rounded-2xl border border-white/10 bg-black/20 p-3"><div class="inline-flex rounded-xl border border-white/10 bg-white/5 p-1"></div><select class="rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-500/40"></select><select class="rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-500/40"></select><button type=button>Advanced Filters</button><button type=button>Clear Filters</button></div><h2 class="text-xl font-bold text-white">'),el=C("<button type=button>"),bt=C("<option>"),ea=C('<button type=button class="rounded-md border border-white/15 bg-white/5 px-2 py-1 text-slate-200 hover:bg-white/10 transition-colors">'),ta=C("<span class=text-slate-500>/"),tl=C('<div class="grid gap-4 sm:grid-cols-2 xl:grid-cols-4">'),nl=C('<div class="grid gap-4 sm:grid-cols-2 xl:grid-cols-3">'),ll=C('<div class="rounded-2xl border border-white/10 bg-black/20 p-8 text-center text-sm text-slate-400">No media items match this view yet.'),Nt=C('<img loading=lazy class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-[1.03]">',!0,!1,!1),na=C('<div class="group overflow-hidden rounded-2xl border border-white/10 bg-black/25 transition-colors hover:border-cyan-400/40"><div class="relative aspect-video overflow-hidden bg-slate-900"><div class="absolute left-2 top-2 rounded-full border border-black/30 bg-black/45 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-white/90"></div></div><div class="space-y-2 p-3"><div class="truncate text-sm font-bold text-white"></div><div class="truncate text-xs text-slate-400"></div><div class="truncate text-[11px] text-slate-500">  </div><div class="flex items-center gap-2"><button type=button class="rounded-lg bg-cyan-500 px-2 py-1 text-xs font-semibold text-slate-950 hover:bg-cyan-400 transition-colors">Play</button><label class="min-w-0 flex-1 text-[10px] font-semibold uppercase tracking-wide text-slate-400">Saved<select class="mt-1 w-full truncate rounded-lg border border-white/10 bg-white/5 px-2 py-1 text-xs text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-500/40 normal-case"><option value>Unassigned'),wt=C('<div class="flex h-full items-center justify-center">'),la=C('<div class="rounded-2xl border border-white/10 bg-black/20 p-8 text-center text-sm text-slate-400">No creators available for this filter set.'),ra=C('<button type=button class="group overflow-hidden rounded-2xl border border-white/10 bg-black/25 text-left transition-colors hover:border-cyan-400/40"><div class="relative aspect-video bg-slate-900"></div><div class="space-y-1 p-3"><div class="truncate text-sm font-bold text-white"></div><div class="text-xs text-slate-400"> item'),ia=C('<div class="rounded-2xl border border-white/10 bg-black/20 p-8 text-center text-sm text-slate-400">No albums available for this artist.'),sa=C('<button type=button class="group overflow-hidden rounded-2xl border border-white/10 bg-black/25 text-left transition-colors hover:border-cyan-400/40"><div class="relative aspect-square bg-slate-900"></div><div class="space-y-1 p-3"><div class="truncate text-sm font-bold text-white"></div><div class="text-xs text-slate-400"> track'),aa=C('<div class="rounded-2xl border border-white/10 bg-black/20 p-8 text-center text-sm text-slate-400">No playlists available for this filter set.'),oa=C('<button type=button class="group overflow-hidden rounded-2xl border border-white/10 bg-black/25 text-left transition-colors hover:border-cyan-400/40"><div class="relative aspect-video bg-slate-900"><div></div></div><div class="space-y-1 p-3"><div class="truncate text-sm font-bold text-white"></div><div class="text-xs text-slate-400"> item'),ca=C('<div class="rounded-2xl border border-white/10 bg-black/20 p-6 text-sm text-slate-400">No artist groups available for this filter set.'),da=C('<button type=button class="group overflow-hidden rounded-2xl border border-white/10 bg-black/25 text-left transition-colors hover:border-cyan-400/40"><div class="relative aspect-video bg-slate-900"></div><div class="space-y-1 p-3"><div class="truncate text-sm font-bold text-white"></div><div class="text-xs text-slate-400"> track'),ua=C('<div class="rounded-2xl border border-white/10 bg-black/20 p-6 text-sm text-slate-400">No channel groups available for this filter set.'),fa=C('<button type=button class="group overflow-hidden rounded-2xl border border-white/10 bg-black/25 text-left transition-colors hover:border-cyan-400/40"><div class="relative aspect-video bg-slate-900"></div><div class="space-y-1 p-3"><div class="truncate text-sm font-bold text-white"></div><div class="text-xs text-slate-400"> video'),ba=C('<div class="overflow-hidden rounded-2xl border border-white/10 bg-black/20"><table class="w-full text-sm"><thead class="bg-white/5 text-xs uppercase tracking-wide text-slate-400"><tr><th class="px-4 py-3 text-left">Name</th><th class="px-4 py-3 text-left">Type</th><th class="px-4 py-3 text-left">Count</th><th class="px-4 py-3 text-left">Latest</th><th class="px-4 py-3 text-right">Action</th></tr></thead><tbody>'),rl=C('<div class="text-xs text-slate-500">'),ya=C('<tr class="border-t border-white/5 text-slate-200"><td class="px-4 py-3"><div class="font-semibold text-white"></div></td><td class="px-4 py-3 text-xs text-slate-400"></td><td class="px-4 py-3 text-xs text-slate-400"></td><td class="px-4 py-3 text-xs text-slate-400"></td><td class="px-4 py-3 text-right"><button type=button class="rounded-lg border border-cyan-400/40 bg-cyan-500/20 px-2 py-1 text-xs font-semibold text-cyan-100 hover:bg-cyan-500/30 transition-colors">Open'),il=C('<img loading=lazy class="h-full w-full object-cover">',!0,!1,!1),ha=C('<tr class="border-t border-white/5 align-top text-slate-200"><td class="px-4 py-3"><div class="flex items-start gap-3"><div class="h-14 w-24 overflow-hidden rounded-lg border border-white/10 bg-slate-900"></div><div class=min-w-0><div class="truncate font-semibold text-white"></div><div class="truncate text-xs text-slate-500">  </div></div></div></td><td class="px-4 py-3 text-xs text-slate-300"></td><td class="px-4 py-3 text-xs text-slate-300"></td><td class="px-4 py-3 text-xs text-slate-300"><div></div><div class=text-slate-500>Saved: </div></td><td class="px-4 py-3 text-xs uppercase text-slate-400"></td><td class="px-4 py-3 text-xs text-slate-400"></td><td class="px-4 py-3"><select class="w-full rounded-lg border border-white/10 bg-white/5 px-2 py-1 text-xs text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-500/40"><option value>Unassigned</option></select></td><td class="px-4 py-3 text-right"><button type=button class="rounded-lg bg-cyan-500 px-2 py-1 text-xs font-semibold text-slate-950 hover:bg-cyan-400 transition-colors">Play'),ga=C('<div class="overflow-hidden rounded-2xl border border-white/10 bg-black/20"><table class="w-full text-sm"><thead class="bg-white/5 text-xs uppercase tracking-wide text-slate-400"><tr><th class="px-4 py-3 text-left">Name</th><th class="px-4 py-3 text-left">Type</th><th class="px-4 py-3 text-left">Count</th></tr></thead><tbody>'),ma=C('<tr><td class="px-4 py-3"><div class="font-semibold text-white"></div></td><td class="px-4 py-3 text-xs text-slate-400"></td><td class="px-4 py-3 text-xs text-slate-400">'),pa=C('<tr><td class="px-4 py-3"><div class="font-semibold text-white"></div><div class="text-xs text-slate-500"></div></td><td class="px-4 py-3 text-xs text-slate-300"></td><td class="px-4 py-3 text-xs text-slate-300"></td><td class="px-4 py-3 text-xs uppercase text-slate-400">'),xa=C('<div class=space-y-3><div><div class="text-[11px] uppercase tracking-wide text-slate-500">Name</div><div class="text-sm font-semibold text-white"></div></div><div><div class="text-[11px] uppercase tracking-wide text-slate-500">Type</div><div class="text-xs text-slate-300"></div></div><div><div class="text-[11px] uppercase tracking-wide text-slate-500">Count</div><div class="text-xs text-slate-300"></div></div><button type=button class="rounded-lg bg-cyan-500 px-3 py-1.5 text-xs font-semibold text-slate-950 hover:bg-cyan-400 transition-colors">Open'),va=C('<div class="text-sm text-slate-500">Select a row to inspect details.'),wa=C('<div class="text-sm text-slate-500">Select an item to inspect metadata.'),$a=C('<a target=_blank rel=noreferrer class="rounded-lg border border-white/20 px-3 py-1.5 text-xs font-semibold text-slate-200 hover:bg-white/10 transition-colors">Source'),_a=C('<div class=space-y-3><div class="overflow-hidden rounded-xl border border-white/10 bg-slate-900"><div class=aspect-video></div></div><div><div class="text-[11px] uppercase tracking-wide text-slate-500">Title</div><div class="text-sm font-semibold text-white"></div></div><div class="grid grid-cols-2 gap-2 text-xs text-slate-300"><div><div class="text-[11px] uppercase tracking-wide text-slate-500">Creator</div><div></div></div><div><div class="text-[11px] uppercase tracking-wide text-slate-500">Collection</div><div></div></div><div><div class="text-[11px] uppercase tracking-wide text-slate-500">Type</div><div class=uppercase></div></div><div><div class="text-[11px] uppercase tracking-wide text-slate-500">Date</div><div></div></div><div class=col-span-2><div class="text-[11px] uppercase tracking-wide text-slate-500">Source Playlist</div><div></div></div></div><label class="block text-[11px] font-semibold uppercase tracking-wide text-slate-500">Saved Playlist<select class="mt-1 w-full rounded-lg border border-white/10 bg-white/5 px-2 py-1.5 text-xs text-slate-100 focus:outline-none focus:ring-2 focus:ring-cyan-500/40 normal-case"><option value>Unassigned</option></select></label><div class="flex items-center gap-2"><button type=button class="rounded-lg bg-cyan-500 px-3 py-1.5 text-xs font-semibold text-slate-950 hover:bg-cyan-400 transition-colors">Play'),Sa=C('<div class="rounded-xl border border-white/10 bg-white/5 p-3 text-xs text-slate-400">No saved playlists yet.'),ka=C('<div class="flex items-center justify-between gap-2 rounded-xl border border-white/10 bg-white/5 px-3 py-2"><div class=min-w-0><div class="truncate text-sm font-semibold text-white"></div><div class="text-[11px] text-slate-500">ID: </div></div><div class="flex items-center gap-1"><button type=button class="rounded-lg border border-white/15 px-2 py-1 text-xs font-semibold text-slate-200 hover:bg-white/10 transition-colors">Rename</button><button type=button class="rounded-lg border border-red-400/30 px-2 py-1 text-xs font-semibold text-red-200 hover:bg-red-500/20 transition-colors">Delete');const sl=[{value:"artists",label:"Artists"},{value:"channels",label:"Channels"},{value:"playlists",label:"Playlists"},{value:"all_media",label:"All Media"}],al=[{value:"gallery",label:"Gallery"},{value:"list",label:"List"},{value:"detail",label:"Detail"}],ol=[{value:"all",label:"All Types"},{value:"audio",label:"Audio"},{value:"video",label:"Video"}],cl=[{value:"newest",label:"Newest first"},{value:"oldest",label:"Oldest first"},{value:"creator_asc",label:"Creator (A-Z)"},{value:"creator_desc",label:"Creator (Z-A)"},{value:"collection_asc",label:"Collection (A-Z)"},{value:"collection_desc",label:"Collection (Z-A)"},{value:"playlist_asc",label:"Playlist (A-Z)"},{value:"playlist_desc",label:"Playlist (Z-A)"}],Ca=80,Tt={creatorType:"",creatorName:"",albumName:"",playlistKey:"",playlistKind:""},dl=e=>String(e||"").trim().replace(/\s+/g," ").slice(0,Ca),Pa=e=>{const t=e&&typeof e=="object"?e:{};return{creatorType:typeof t.creatorType=="string"?t.creatorType:"",creatorName:typeof t.creatorName=="string"?t.creatorName:"",albumName:typeof t.albumName=="string"?t.albumName:"",playlistKey:typeof t.playlistKey=="string"?t.playlistKey:"",playlistKind:typeof t.playlistKind=="string"?t.playlistKind:""}},Aa=e=>{const t=e&&typeof e=="object"?e:{};return{query:typeof t.query=="string"?t.query:"",creator:typeof t.creator=="string"?t.creator:"",collection:typeof t.collection=="string"?t.collection:"",playlist:typeof t.playlist=="string"?t.playlist:"",savedPlaylistId:typeof t.savedPlaylistId=="string"?t.savedPlaylistId:""}},Na=e=>{const t=e&&typeof e=="object"?e:{};return{advancedFiltersOpen:!!t.advancedFiltersOpen,metadataBannerDismissed:!!t.metadataBannerDismissed}},ul=(...e)=>{for(const t of e)if(typeof t=="string"){const n=t.trim();if(n!=="")return n}return""};function Ta(e){const[t,n]=Ie(""),[l,r]=Ie(""),[i,o]=Ie("neutral"),[c,u]=Ie(!1),[$,P]=Ie({}),[p,j]=Ie(""),[J,le]=Ie(""),re=z(()=>{const d=typeof e.downloads=="function"?e.downloads():e.downloads;return Array.isArray(d)?d:[]}),V=z(()=>{const d=typeof e.section=="function"?e.section():e.section;return sl.some(h=>h.value===d)?d:"artists"}),se=z(()=>{const d=typeof e.viewMode=="function"?e.viewMode():e.viewMode;return al.some(h=>h.value===d)?d:"gallery"}),_e=z(()=>{const d=typeof e.typeFilter=="function"?e.typeFilter():e.typeFilter;return ol.some(h=>h.value===d)?d:"all"}),fe=z(()=>{const d=typeof e.navPath=="function"?e.navPath():e.navPath;return Pa(d)}),F=z(()=>{const d=typeof e.filters=="function"?e.filters():e.filters;return Aa(d)}),Pe=z(()=>{const d=typeof e.sortKey=="function"?e.sortKey():e.sortKey;return cl.some(h=>h.value===d)?d:"newest"}),Se=z(()=>{const d=typeof e.savedPlaylists=="function"?e.savedPlaylists():e.savedPlaylists;return Array.isArray(d)?d:[]}),Te=z(()=>{const d=typeof e.playlistAssignments=="function"?e.playlistAssignments():e.playlistAssignments;return d&&typeof d=="object"?d:{}}),Be=z(()=>{const d=typeof e.savedPlaylistSyncError=="function"?e.savedPlaylistSyncError():e.savedPlaylistSyncError;return typeof d=="string"?d.trim():""}),Ve=z(()=>{const d=typeof e.uiState=="function"?e.uiState():e.uiState;return Na(d)}),ke=z(()=>js({downloads:re(),savedPlaylists:Se(),playlistAssignments:Te(),typeFilter:_e(),sortKey:Pe(),filters:F()})),Me=(d,h)=>{o(d),r(h)},tt=()=>{typeof e.onNavPathChange=="function"&&e.onNavPathChange({...Tt})},Ee=d=>{typeof e.onNavPathChange=="function"&&e.onNavPathChange({...Tt,...d})},Le=(d,h)=>{typeof e.onFilterChange=="function"&&e.onFilterChange(d,h)},Ae=z(()=>{const d=F();return d.query!==""||d.creator!==""||d.collection!==""||d.playlist!==""||d.savedPlaylistId!==""}),ot=()=>{if(typeof e.onClearFilters=="function"){e.onClearFilters();return}Le("query",""),Le("creator",""),Le("collection",""),Le("playlist",""),Le("savedPlaylistId","")},Fe=d=>{typeof e.onSectionChange=="function"&&e.onSectionChange(d),tt(),j("")},ct=d=>{typeof e.onViewModeChange=="function"&&e.onViewModeChange(d),j("")},Je=d=>{typeof e.onTypeFilterChange=="function"&&e.onTypeFilterChange(d),tt(),j("")},Ge=(d,h)=>{P(A=>({...A,[d]:h}))},ze=(d,h)=>typeof h=="string"&&h.trim()!==""&&$()[d]!==h,pt=async()=>{if(typeof e.onRetryMetadataScan=="function")try{const d=await e.onRetryMetadataScan(),h=typeof(d==null?void 0:d.message)=="string"&&d.message.trim()!==""?d.message.trim():"Library refreshed. Legacy files without sidecar metadata may require re-download for full metadata and thumbnails.";le(h)}catch{le("Retry failed. Please check backend logs and try again.")}},xt=()=>{typeof e.onDismissMetadataBanner=="function"&&e.onDismissMetadataBanner()},v=async()=>{const d=dl(t());if(d===""){Me("error","Enter a playlist name.");return}if(typeof e.onCreateSavedPlaylist!="function")return;const h=await e.onCreateSavedPlaylist(d);if(!h||h.ok===!1){Me("error",(h==null?void 0:h.error)||"Unable to create saved playlist.");return}n(""),Me("success",`Saved playlist "${d}" created.`)},W=async d=>{if(typeof window>"u"||typeof e.onRenameSavedPlaylist!="function")return;const h=window.prompt("Rename saved playlist",d.name);if(h===null)return;const A=await e.onRenameSavedPlaylist(d.id,h);if(!A||A.ok===!1){Me("error",(A==null?void 0:A.error)||"Unable to rename saved playlist.");return}const x=dl(h);Me("success",`Saved playlist renamed to "${x||d.name}".`)},Z=async d=>{if(typeof window>"u"||typeof e.onDeleteSavedPlaylist!="function"||!window.confirm(`Delete "${d.name}" and remove its assignments?`))return;const A=await e.onDeleteSavedPlaylist(d.id);if(!A||A.ok===!1){Me("error",(A==null?void 0:A.error)||"Unable to delete saved playlist.");return}Me("success",`Saved playlist "${d.name}" deleted.`)},De=(d,h)=>{typeof e.onAssignSavedPlaylist=="function"&&d.mediaKey!==""&&e.onAssignSavedPlaylist(d.mediaKey,h)},Oe=(d,h)=>{if(typeof e.openPlayer!="function")return;const A=Array.isArray(h)?h:[];e.openPlayer(d.raw,A.map(x=>x.raw))},K=z(()=>{const d=ke(),h=V(),A=fe();if(h==="artists"){if(A.creatorType==="artist"&&A.creatorName!==""){const x=d.artistsByName.get(A.creatorName);if(!x)return{kind:"landing",title:"Artists & Channels",subtitle:"Browse creators by recent activity.",artists:d.artists,channels:d.channels,breadcrumbs:[]};if(A.albumName!==""){const ce=x.albums.find(Ue=>Ue.name===A.albumName);if(ce)return{kind:"items",title:ce.name,subtitle:`${x.name}  ${ce.count} item${ce.count===1?"":"s"}`,items:ce.items,queueItems:ce.items,breadcrumbs:[{label:"Artists",nav:{...Tt}},{label:x.name,nav:{creatorType:"artist",creatorName:x.name}},{label:ce.name,nav:{creatorType:"artist",creatorName:x.name,albumName:ce.name}}]}}return{kind:"albums",title:x.name,subtitle:`${x.count} track${x.count===1?"":"s"} across ${x.albums.length} album${x.albums.length===1?"":"s"}`,albums:x.albums,creator:x,breadcrumbs:[{label:"Artists",nav:{...Tt}},{label:x.name,nav:{creatorType:"artist",creatorName:x.name}}]}}return{kind:"landing",title:"Artists & Channels",subtitle:"Rows of creator cards sorted by recent downloads.",artists:d.artists,channels:d.channels,breadcrumbs:[]}}if(h==="channels"){if(A.creatorType==="channel"&&A.creatorName!==""){const x=d.channelsByName.get(A.creatorName);if(x)return{kind:"items",title:x.name,subtitle:`${x.count} video${x.count===1?"":"s"}`,items:x.items,queueItems:x.items,breadcrumbs:[{label:"Channels",nav:{...Tt}},{label:x.name,nav:{creatorType:"channel",creatorName:x.name}}]}}return{kind:"creators",title:"Channels",subtitle:"Browse downloaded videos by channel.",creators:d.channels,creatorType:"channel",breadcrumbs:[]}}if(h==="playlists"){if(A.playlistKey!==""){const x=d.playlistsByKey.get(A.playlistKey);if(x)return{kind:"items",title:x.name,subtitle:`${x.count} item${x.count===1?"":"s"}  ${x.kind==="source"?"Source playlist":"Saved playlist"}`,items:x.items,queueItems:x.items,breadcrumbs:[{label:"Playlists",nav:{...Tt}},{label:x.name,nav:{playlistKey:x.key,playlistKind:x.kind}}]}}return{kind:"playlists",title:"Playlists",subtitle:"Combined source and saved playlists.",playlists:d.playlists,sourcePlaylists:d.sourcePlaylists,savedPlaylists:d.savedPlaylists,breadcrumbs:[]}}return{kind:"items",title:"All Media",subtitle:`${d.filteredItems.length} filtered item${d.filteredItems.length===1?"":"s"}`,items:d.filteredItems,queueItems:d.filteredItems,breadcrumbs:[]}}),s=z(()=>{const d=K();if(d.kind==="landing"){const h=d.artists.map(x=>({key:`artist:${x.name}`,name:x.name,type:"Artist",count:x.count,latestTimestamp:x.latestTimestamp,thumbnailUrl:x.thumbnailUrl,subtitle:`${x.albums.length} album${x.albums.length===1?"":"s"}`,onOpen:()=>Ee({creatorType:"artist",creatorName:x.name})})),A=d.channels.map(x=>({key:`channel:${x.name}`,name:x.name,type:"Channel",count:x.count,latestTimestamp:x.latestTimestamp,thumbnailUrl:x.thumbnailUrl,subtitle:"Video library",onOpen:()=>{Fe("channels"),Ee({creatorType:"channel",creatorName:x.name})}}));return[...h,...A].sort((x,ce)=>ce.latestTimestamp-x.latestTimestamp)}return d.kind==="creators"?d.creators.map(h=>{var A,x;return{key:`${d.creatorType}:${h.name}`,name:h.name,type:d.creatorType==="channel"?"Channel":"Artist",count:h.count,latestTimestamp:h.latestTimestamp,thumbnailUrl:h.thumbnailUrl,subtitle:d.creatorType==="channel"?"Video library":`${((A=h.albums)==null?void 0:A.length)||0} album${(((x=h.albums)==null?void 0:x.length)||0)===1?"":"s"}`,onOpen:()=>Ee({creatorType:d.creatorType,creatorName:h.name})}}):d.kind==="albums"?d.albums.map(h=>({key:`album:${h.name}`,name:h.name,type:"Album",count:h.count,latestTimestamp:h.latestTimestamp,thumbnailUrl:h.thumbnailUrl,subtitle:d.creator.name,onOpen:()=>Ee({creatorType:"artist",creatorName:d.creator.name,albumName:h.name})})):d.kind==="playlists"?d.playlists.map(h=>({key:h.key,name:h.name,type:h.kind==="source"?"Source Playlist":"Saved Playlist",count:h.count,latestTimestamp:h.latestTimestamp,thumbnailUrl:h.thumbnailUrl,subtitle:h.kind==="saved"&&h.count===0?"No assignments yet":"",onOpen:()=>Ee({playlistKey:h.key,playlistKind:h.kind})})):[]}),y=z(()=>K().kind==="items"?K().items:[]),g=z(()=>K().kind==="items"?K().queueItems:[]),S=z(()=>K().kind==="creators"?K().creators:[]),b=z(()=>K().kind==="albums"?K().albums:[]),M=z(()=>K().kind==="playlists"?K().playlists:[]),w=z(()=>K().kind==="landing"?K().artists:[]),I=z(()=>K().kind==="landing"?K().channels:[]);gt(()=>{var ce,Ue;const d=K(),h=p();if(se()!=="detail")return;if(d.kind==="items"){const je=((ce=d.items[0])==null?void 0:ce.mediaKey)||"";d.items.some(me=>me.mediaKey===h)||j(je);return}const A=s(),x=((Ue=A[0])==null?void 0:Ue.key)||"";A.some(je=>je.key===h)||j(x)});const Q=z(()=>{const d=K();return d.kind!=="items"?null:d.items.find(h=>h.mediaKey===p())||null}),oe=z(()=>s().find(h=>h.key===p())||null),ge=z(()=>{const d=K();return d.kind==="items"?`${d.items.length} items`:d.kind==="albums"?`${d.albums.length} albums`:d.kind==="playlists"?`${d.playlists.length} playlists`:d.kind==="creators"?`${d.creators.length} creators`:d.kind==="landing"?`${d.artists.length+d.channels.length} creators`:""});return(()=>{var d=Zs(),h=d.firstChild,A=h.firstChild,x=A.firstChild,ce=x.firstChild,Ue=ce.nextSibling,je=x.nextSibling,me=je.firstChild,nt=me.firstChild,Ye=nt.firstChild,dt=Ye.nextSibling,ut=nt.nextSibling,Qe=me.nextSibling,E=Qe.firstChild,ee=E.nextSibling,B=ee.nextSibling,ae=B.nextSibling,de=ae.nextSibling,Re=Qe.nextSibling;return a(Ue,f(ye,{each:sl,children:k=>(()=>{var m=el();return m.$$click=()=>Fe(k.value),a(m,()=>k.label),U(()=>pe(m,`w-full rounded-xl px-3 py-2 text-left text-sm font-semibold transition-colors ${V()===k.value?"bg-cyan-500/20 text-cyan-100 border border-cyan-400/40":"text-slate-300 hover:text-white hover:bg-white/10 border border-transparent"}`)),m})()})),a(dt,()=>K().subtitle),a(ut,ge),a(je,f(L,{get when(){return et(()=>ke().anomalyCount>0)()&&!Ve().metadataBannerDismissed},get children(){var k=zs(),m=k.firstChild,D=m.firstChild,N=D.firstChild,_=N.firstChild,X=_.nextSibling;X.nextSibling;var O=D.nextSibling,G=O.firstChild,te=G.nextSibling;return a(N,()=>ke().anomalyCount,_),a(N,()=>ke().anomalyCount===1?"":"s",X),G.$$click=()=>{pt()},te.$$click=xt,a(k,f(L,{get when(){return J()!==""},get children(){var T=Fs();return a(T,J),T}}),null),k}}),Qe),a(E,f(ye,{each:al,children:k=>(()=>{var m=el();return m.$$click=()=>ct(k.value),a(m,()=>k.label),U(()=>pe(m,`rounded-lg px-3 py-1.5 text-xs font-semibold transition-colors ${se()===k.value?"bg-cyan-500/30 text-cyan-100":"text-slate-300 hover:text-white hover:bg-white/10"}`)),m})()})),ee.addEventListener("change",k=>Je(k.currentTarget.value)),a(ee,f(ye,{each:ol,children:k=>(()=>{var m=bt();return a(m,()=>k.label),U(()=>m.value=k.value),m})()})),B.addEventListener("change",k=>{typeof e.onSortKeyChange=="function"&&e.onSortKeyChange(k.currentTarget.value)}),a(B,f(ye,{each:cl,children:k=>(()=>{var m=bt();return a(m,()=>k.label),U(()=>m.value=k.value),m})()})),ae.$$click=()=>{typeof e.onToggleAdvancedFilters=="function"&&e.onToggleAdvancedFilters()},a(Qe,f(L,{get when(){return V()==="playlists"},get children(){var k=Rs();return k.$$click=()=>u(!0),k}}),de),de.$$click=ot,a(je,f(L,{get when(){return Ve().advancedFiltersOpen},get children(){var k=Ks(),m=k.firstChild,D=m.firstChild,N=D.nextSibling,_=m.nextSibling,X=_.firstChild,O=X.nextSibling;O.firstChild;var G=_.nextSibling,te=G.firstChild,T=te.nextSibling;T.firstChild;var q=G.nextSibling,ne=q.firstChild,R=ne.nextSibling;R.firstChild;var Y=q.nextSibling,Ne=Y.firstChild,ve=Ne.nextSibling;return ve.firstChild,N.$$input=H=>Le("query",H.currentTarget.value),O.addEventListener("change",H=>Le("creator",H.currentTarget.value)),a(O,f(ye,{get each(){return ke().filterOptions.creators},children:H=>(()=>{var ue=bt();return ue.value=H,a(ue,H),ue})()}),null),T.addEventListener("change",H=>Le("collection",H.currentTarget.value)),a(T,f(ye,{get each(){return ke().filterOptions.collections},children:H=>(()=>{var ue=bt();return ue.value=H,a(ue,H),ue})()}),null),R.addEventListener("change",H=>Le("playlist",H.currentTarget.value)),a(R,f(ye,{get each(){return ke().filterOptions.sourcePlaylists},children:H=>(()=>{var ue=bt();return ue.value=H,a(ue,H),ue})()}),null),ve.addEventListener("change",H=>Le("savedPlaylistId",H.currentTarget.value)),a(ve,f(ye,{get each(){return Se()},children:H=>(()=>{var ue=bt();return a(ue,()=>H.name),U(()=>ue.value=H.id),ue})()}),null),U(()=>N.value=F().query),U(()=>O.value=F().creator),U(()=>T.value=F().collection),U(()=>R.value=F().playlist),U(()=>ve.value=F().savedPlaylistId),k}}),Re),a(je,f(L,{get when(){return Be()!==""},get children(){var k=qs(),m=k.firstChild;return a(m,Be),a(k,f(L,{get when(){return typeof e.onRetrySavedPlaylistSync=="function"},get children(){var D=Is();return D.$$click=()=>{e.onRetrySavedPlaylistSync()},D}}),null),k}}),Re),a(je,f(L,{get when(){return K().breadcrumbs.length>0},get children(){var k=Bs();return a(k,f(ye,{get each(){return K().breadcrumbs},children:(m,D)=>[(()=>{var N=ea();return N.$$click=()=>Ee(m.nav),a(N,()=>m.label),N})(),f(L,{get when(){return D()<K().breadcrumbs.length-1},get children(){return ta()}})]})),k}}),Re),a(Re,()=>K().title),a(d,f(L,{get when(){return se()==="gallery"},get children(){return f(L,{get when(){return K().kind==="landing"},get fallback(){return f(L,{get when(){return K().kind!=="items"},get fallback(){return f(L,{get when(){return y().length>0},get fallback(){return ll()},get children(){var k=nl();return a(k,f(ye,{get each(){return y()},children:m=>{const D=`media:${m.mediaKey}`;return(()=>{var N=na(),_=N.firstChild,X=_.firstChild,O=_.nextSibling,G=O.firstChild,te=G.nextSibling,T=te.nextSibling,q=T.firstChild,ne=T.nextSibling,R=ne.firstChild,Y=R.nextSibling,Ne=Y.firstChild,ve=Ne.nextSibling;return ve.firstChild,a(_,f(L,{get when(){return ze(D,m.thumbnailUrl)},get fallback(){return(()=>{var H=wt();return a(H,f(ie,{get name(){return m.type==="audio"?"music":"film"},class:"h-8 w-8 text-slate-500"})),H})()},get children(){var H=Nt();return H.addEventListener("error",()=>Ge(D,m.thumbnailUrl)),U(ue=>{var vt=m.thumbnailUrl,_t=m.title;return vt!==ue.e&&be(H,"src",ue.e=vt),_t!==ue.t&&be(H,"alt",ue.t=_t),ue},{e:void 0,t:void 0}),H}}),X),a(X,()=>m.type),a(G,()=>m.title),a(te,()=>m.creator),a(T,()=>m.album,q),a(T,()=>m.date||m.modifiedAt,null),R.$$click=()=>Oe(m,g()),ve.addEventListener("change",H=>De(m,H.currentTarget.value)),a(ve,f(ye,{get each(){return Se()},children:H=>(()=>{var ue=bt();return a(ue,()=>H.name),U(()=>ue.value=H.id),ue})()}),null),U(()=>ve.value=m.savedPlaylistId),N})()}})),k}})},get children(){return[f(L,{get when(){return K().kind==="creators"},get children(){return f(L,{get when(){return S().length>0},get fallback(){return la()},get children(){var k=tl();return a(k,f(ye,{get each(){return S()},children:m=>{const D=`creator:${K().creatorType}:${m.name}`;return(()=>{var N=ra(),_=N.firstChild,X=_.nextSibling,O=X.firstChild,G=O.nextSibling,te=G.firstChild;return N.$$click=()=>Ee({creatorType:K().creatorType,creatorName:m.name}),a(_,f(L,{get when(){return ze(D,m.thumbnailUrl)},get fallback(){return(()=>{var T=wt();return a(T,f(ie,{get name(){return K().creatorType==="channel"?"film":"music"},class:"h-8 w-8 text-slate-500"})),T})()},get children(){var T=Nt();return T.addEventListener("error",()=>Ge(D,m.thumbnailUrl)),U(q=>{var ne=m.thumbnailUrl,R=m.name;return ne!==q.e&&be(T,"src",q.e=ne),R!==q.t&&be(T,"alt",q.t=R),q},{e:void 0,t:void 0}),T}})),a(O,()=>m.name),a(G,()=>m.count,te),a(G,()=>m.count===1?"":"s",null),N})()}})),k}})}}),f(L,{get when(){return K().kind==="albums"},get children(){return f(L,{get when(){return b().length>0},get fallback(){return ia()},get children(){var k=tl();return a(k,f(ye,{get each(){return b()},children:m=>{const D=`album:${K().creator.name}:${m.name}`;return(()=>{var N=sa(),_=N.firstChild,X=_.nextSibling,O=X.firstChild,G=O.nextSibling,te=G.firstChild;return N.$$click=()=>Ee({creatorType:"artist",creatorName:K().creator.name,albumName:m.name}),a(_,f(L,{get when(){return ze(D,m.thumbnailUrl)},get fallback(){return(()=>{var T=wt();return a(T,f(ie,{name:"music",class:"h-8 w-8 text-slate-500"})),T})()},get children(){var T=Nt();return T.addEventListener("error",()=>Ge(D,m.thumbnailUrl)),U(q=>{var ne=m.thumbnailUrl,R=m.name;return ne!==q.e&&be(T,"src",q.e=ne),R!==q.t&&be(T,"alt",q.t=R),q},{e:void 0,t:void 0}),T}})),a(O,()=>m.name),a(G,()=>m.count,te),a(G,()=>m.count===1?"":"s",null),N})()}})),k}})}}),f(L,{get when(){return K().kind==="playlists"},get children(){return f(L,{get when(){return M().length>0},get fallback(){return aa()},get children(){var k=nl();return a(k,f(ye,{get each(){return M()},children:m=>{const D=`playlist:${m.key}`;return(()=>{var N=oa(),_=N.firstChild,X=_.firstChild,O=_.nextSibling,G=O.firstChild,te=G.nextSibling,T=te.firstChild;return N.$$click=()=>Ee({playlistKey:m.key,playlistKind:m.kind}),a(_,f(L,{get when(){return ze(D,m.thumbnailUrl)},get fallback(){return(()=>{var q=wt();return a(q,f(ie,{name:"layers",class:"h-8 w-8 text-slate-500"})),q})()},get children(){var q=Nt();return q.addEventListener("error",()=>Ge(D,m.thumbnailUrl)),U(ne=>{var R=m.thumbnailUrl,Y=m.name;return R!==ne.e&&be(q,"src",ne.e=R),Y!==ne.t&&be(q,"alt",ne.t=Y),ne},{e:void 0,t:void 0}),q}}),X),a(X,()=>m.kind),a(G,()=>m.name),a(te,()=>m.count,T),a(te,()=>m.count===1?"":"s",null),U(()=>pe(X,`absolute left-2 top-2 rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide ${m.kind==="source"?"border-emerald-300/50 bg-emerald-500/20 text-emerald-100":"border-cyan-300/50 bg-cyan-500/20 text-cyan-100"}`)),N})()}})),k}})}})]}})},get children(){var k=Ys();return a(k,f(L,{get when(){return w().length>0},get fallback(){return ca()},get children(){var m=Vs(),D=m.firstChild,N=D.nextSibling;return a(N,f(ye,{get each(){return w()},children:_=>{const X=`artist:${_.name}`;return(()=>{var O=da(),G=O.firstChild,te=G.nextSibling,T=te.firstChild,q=T.nextSibling,ne=q.firstChild;return O.$$click=()=>Ee({creatorType:"artist",creatorName:_.name}),a(G,f(L,{get when(){return ze(X,_.thumbnailUrl)},get fallback(){return(()=>{var R=wt();return a(R,f(ie,{name:"music",class:"h-8 w-8 text-slate-500"})),R})()},get children(){var R=Nt();return R.addEventListener("error",()=>Ge(X,_.thumbnailUrl)),U(Y=>{var Ne=_.thumbnailUrl,ve=_.name;return Ne!==Y.e&&be(R,"src",Y.e=Ne),ve!==Y.t&&be(R,"alt",Y.t=ve),Y},{e:void 0,t:void 0}),R}})),a(T,()=>_.name),a(q,()=>_.count,ne),a(q,()=>_.count===1?"":"s",null),O})()}})),m}}),null),a(k,f(L,{get when(){return I().length>0},get fallback(){return ua()},get children(){var m=Gs(),D=m.firstChild,N=D.nextSibling;return a(N,f(ye,{get each(){return I()},children:_=>{const X=`channel:${_.name}`;return(()=>{var O=fa(),G=O.firstChild,te=G.nextSibling,T=te.firstChild,q=T.nextSibling,ne=q.firstChild;return O.$$click=()=>{Fe("channels"),Ee({creatorType:"channel",creatorName:_.name})},a(G,f(L,{get when(){return ze(X,_.thumbnailUrl)},get fallback(){return(()=>{var R=wt();return a(R,f(ie,{name:"film",class:"h-8 w-8 text-slate-500"})),R})()},get children(){var R=Nt();return R.addEventListener("error",()=>Ge(X,_.thumbnailUrl)),U(Y=>{var Ne=_.thumbnailUrl,ve=_.name;return Ne!==Y.e&&be(R,"src",Y.e=Ne),ve!==Y.t&&be(R,"alt",Y.t=ve),Y},{e:void 0,t:void 0}),R}})),a(T,()=>_.name),a(q,()=>_.count,ne),a(q,()=>_.count===1?"":"s",null),O})()}})),m}}),null),k}})}}),null),a(d,f(L,{get when(){return se()==="list"},get children(){return f(L,{get when(){return K().kind==="items"},get fallback(){return(()=>{var k=ba(),m=k.firstChild,D=m.firstChild,N=D.nextSibling;return a(N,f(ye,{get each(){return s()},children:_=>(()=>{var X=ya(),O=X.firstChild,G=O.firstChild,te=O.nextSibling,T=te.nextSibling,q=T.nextSibling,ne=q.nextSibling,R=ne.firstChild;return a(G,()=>_.name),a(O,f(L,{get when(){return _.subtitle!==""},get children(){var Y=rl();return a(Y,()=>_.subtitle),Y}}),null),a(te,()=>_.type),a(T,()=>_.count),a(q,(()=>{var Y=et(()=>_.latestTimestamp>0);return()=>Y()?new Date(_.latestTimestamp).toLocaleDateString():"-"})()),Al(R,"click",_.onOpen,!0),X})()})),k})()},get children(){return f(L,{get when(){return y().length>0},get fallback(){return ll()},get children(){var k=Qs(),m=k.firstChild,D=m.firstChild,N=D.nextSibling;return a(N,f(ye,{get each(){return y()},children:_=>{const X=`list:${_.mediaKey}`;return(()=>{var O=ha(),G=O.firstChild,te=G.firstChild,T=te.firstChild,q=T.nextSibling,ne=q.firstChild,R=ne.nextSibling,Y=R.firstChild,Ne=G.nextSibling,ve=Ne.nextSibling,H=ve.nextSibling,ue=H.firstChild,vt=ue.nextSibling;vt.firstChild;var _t=H.nextSibling,Xt=_t.nextSibling,Ft=Xt.nextSibling,Ct=Ft.firstChild;Ct.firstChild;var mn=Ft.nextSibling,pn=mn.firstChild;return a(T,f(L,{get when(){return ze(X,_.thumbnailUrl)},get fallback(){return(()=>{var Xe=wt();return a(Xe,f(ie,{get name(){return _.type==="audio"?"music":"film"},class:"h-5 w-5 text-slate-500"})),Xe})()},get children(){var Xe=il();return Xe.addEventListener("error",()=>Ge(X,_.thumbnailUrl)),U(rt=>{var zt=_.thumbnailUrl,Ht=_.title;return zt!==rt.e&&be(Xe,"src",rt.e=zt),Ht!==rt.t&&be(Xe,"alt",rt.t=Ht),rt},{e:void 0,t:void 0}),Xe}})),a(ne,()=>_.title),a(R,()=>_.size||"Unknown size",Y),a(R,()=>_.filename,null),a(Ne,()=>_.creator),a(ve,()=>_.album),a(ue,()=>_.sourcePlaylist),a(vt,()=>_.savedPlaylistName,null),a(_t,()=>_.type),a(Xt,()=>ul(_.date,_.modifiedAt)),Ct.addEventListener("change",Xe=>De(_,Xe.currentTarget.value)),a(Ct,f(ye,{get each(){return Se()},children:Xe=>(()=>{var rt=bt();return a(rt,()=>Xe.name),U(()=>rt.value=Xe.id),rt})()}),null),pn.$$click=()=>Oe(_,g()),U(()=>Ct.value=_.savedPlaylistId),O})()}})),k}})}})}}),null),a(d,f(L,{get when(){return se()==="detail"},get children(){var k=Xs(),m=k.firstChild;return a(k,f(L,{get when(){return K().kind==="items"},get fallback(){return(()=>{var D=ga(),N=D.firstChild,_=N.firstChild,X=_.nextSibling;return a(X,f(ye,{get each(){return s()},children:O=>(()=>{var G=ma(),te=G.firstChild,T=te.firstChild,q=te.nextSibling,ne=q.nextSibling;return G.$$click=()=>j(O.key),a(T,()=>O.name),a(te,f(L,{get when(){return O.subtitle!==""},get children(){var R=rl();return a(R,()=>O.subtitle),R}}),null),a(q,()=>O.type),a(ne,()=>O.count),U(()=>pe(G,`cursor-pointer border-t border-white/5 text-slate-200 transition-colors ${p()===O.key?"bg-cyan-500/10":"hover:bg-white/5"}`)),G})()})),D})()},get children(){var D=Ws(),N=D.firstChild,_=N.firstChild,X=_.nextSibling;return a(X,f(ye,{get each(){return y()},children:O=>(()=>{var G=pa(),te=G.firstChild,T=te.firstChild,q=T.nextSibling,ne=te.nextSibling,R=ne.nextSibling,Y=R.nextSibling;return G.$$click=()=>j(O.mediaKey),a(T,()=>O.title),a(q,()=>O.filename),a(ne,()=>O.creator),a(R,()=>O.album),a(Y,()=>O.type),U(()=>pe(G,`cursor-pointer border-t border-white/5 text-slate-200 transition-colors ${p()===O.mediaKey?"bg-cyan-500/10":"hover:bg-white/5"}`)),G})()})),D}}),m),a(m,f(L,{get when(){return K().kind==="items"},get fallback(){return f(L,{get when(){return oe()},get fallback(){return va()},get children(){var D=xa(),N=D.firstChild,_=N.firstChild,X=_.nextSibling,O=N.nextSibling,G=O.firstChild,te=G.nextSibling,T=O.nextSibling,q=T.firstChild,ne=q.nextSibling,R=T.nextSibling;return a(X,()=>{var Y;return(Y=oe())==null?void 0:Y.name}),a(te,()=>{var Y;return(Y=oe())==null?void 0:Y.type}),a(ne,()=>{var Y;return(Y=oe())==null?void 0:Y.count}),R.$$click=()=>{var Y,Ne;return(Ne=(Y=oe())==null?void 0:Y.onOpen)==null?void 0:Ne.call(Y)},D}})},get children(){return f(L,{get when(){return Q()},get fallback(){return wa()},children:D=>{const N=D(),_=`detail:${N.mediaKey}`;return(()=>{var X=_a(),O=X.firstChild,G=O.firstChild,te=O.nextSibling,T=te.firstChild,q=T.nextSibling,ne=te.nextSibling,R=ne.firstChild,Y=R.firstChild,Ne=Y.nextSibling,ve=R.nextSibling,H=ve.firstChild,ue=H.nextSibling,vt=ve.nextSibling,_t=vt.firstChild,Xt=_t.nextSibling,Ft=vt.nextSibling,Ct=Ft.firstChild,mn=Ct.nextSibling,pn=Ft.nextSibling,Xe=pn.firstChild,rt=Xe.nextSibling,zt=ne.nextSibling,Ht=zt.firstChild,Jt=Ht.nextSibling;Jt.firstChild;var On=zt.nextSibling,Bl=On.firstChild;return a(G,f(L,{get when(){return ze(_,N.thumbnailUrl)},get fallback(){return(()=>{var We=wt();return a(We,f(ie,{get name(){return N.type==="audio"?"music":"film"},class:"h-8 w-8 text-slate-500"})),We})()},get children(){var We=il();return We.addEventListener("error",()=>Ge(_,N.thumbnailUrl)),U(ft=>{var Dn=N.thumbnailUrl,Un=N.title;return Dn!==ft.e&&be(We,"src",ft.e=Dn),Un!==ft.t&&be(We,"alt",ft.t=Un),ft},{e:void 0,t:void 0}),We}})),a(q,()=>N.title),a(Ne,()=>N.creator),a(ue,()=>N.album),a(Xt,()=>N.type),a(mn,()=>ul(N.date,N.modifiedAt,"-")),a(rt,()=>N.sourcePlaylist),Jt.addEventListener("change",We=>De(N,We.currentTarget.value)),a(Jt,f(ye,{get each(){return Se()},children:We=>(()=>{var ft=bt();return a(ft,()=>We.name),U(()=>ft.value=We.id),ft})()}),null),Bl.$$click=()=>Oe(N,g()),a(On,f(L,{get when(){return N.sourceURL!==""},get children(){var We=$a();return U(()=>be(We,"href",N.sourceURL)),We}}),null),U(()=>Jt.value=N.savedPlaylistId),X})()}})}})),k}}),null),a(d,f(L,{get when(){return c()},get children(){var k=Js(),m=k.firstChild,D=m.firstChild,N=D.firstChild,_=N.nextSibling,X=D.nextSibling,O=X.firstChild,G=O.nextSibling,te=X.nextSibling;return _.$$click=()=>u(!1),a(_,f(ie,{name:"x",class:"h-4 w-4"})),O.$$keydown=T=>{T.key==="Enter"&&(T.preventDefault(),v())},O.$$input=T=>n(T.currentTarget.value),G.$$click=()=>{v()},a(m,f(L,{get when(){return l()!==""},get children(){var T=Hs();return a(T,l),U(()=>pe(T,`mt-2 text-xs ${i()==="error"?"text-red-300":i()==="success"?"text-emerald-300":"text-slate-400"}`)),T}}),te),a(te,f(L,{get when(){return Se().length>0},get fallback(){return Sa()},get children(){return f(ye,{get each(){return Se()},children:T=>(()=>{var q=ka(),ne=q.firstChild,R=ne.firstChild,Y=R.nextSibling;Y.firstChild;var Ne=ne.nextSibling,ve=Ne.firstChild,H=ve.nextSibling;return a(R,()=>T.name),a(Y,()=>T.id,null),ve.$$click=()=>{W(T)},H.$$click=()=>{Z(T)},q})()})}})),U(()=>O.value=t()),k}}),null),U(k=>{var m=`rounded-xl border px-3 py-2 text-xs font-semibold transition-colors ${Ve().advancedFiltersOpen?"border-cyan-400/40 bg-cyan-500/20 text-cyan-100":"border-white/10 bg-white/5 text-slate-200 hover:bg-white/10"}`,D=!Ae(),N=`ml-auto rounded-xl border px-3 py-2 text-xs font-semibold transition-colors ${Ae()?"border-white/20 bg-white/5 text-slate-100 hover:bg-white/10":"border-white/10 bg-white/5 text-slate-500 cursor-not-allowed"}`;return m!==k.e&&pe(ae,k.e=m),D!==k.t&&(de.disabled=k.t=D),N!==k.a&&pe(de,k.a=N),k},{e:void 0,t:void 0,a:void 0}),U(()=>ee.value=_e()),U(()=>B.value=Pe()),d})()}jt(["click","input","keydown"]);var Ma=C('<div class=space-y-6><h1 class="text-3xl font-black text-white">System Settings</h1><div class="p-8 bg-[#0a0c14] border border-white/5 rounded-[2rem] space-y-6"><div class="flex items-center justify-between"><div><div class="font-bold text-white">YouTube Auth Cookies</div><div class="text-xs text-gray-500">Currently synced from local browser</div></div><div class="relative has-tooltip"><span class="tooltip bg-gray-800 text-[10px] px-2 py-1 rounded shadow-xl mb-4 border border-white/10 w-44 text-center leading-relaxed">Coming Soon: manual cookie re-sync from this panel.</span><button type=button disabled aria-disabled=true aria-label="Re-sync cookies (Coming Soon)"class="px-4 py-2 bg-white/5 rounded-xl text-xs font-bold text-gray-500 border border-white/10 cursor-not-allowed opacity-70">Re-sync</button></div></div><div class="h-[1px] bg-white/5"></div><div class="flex items-center justify-between"><div><div class="font-bold text-white">PO Token Extension</div><div class="text-xs text-gray-500">Enable third-party providers for token generation</div></div><div class="relative has-tooltip"><span class="tooltip bg-gray-800 text-[10px] px-2 py-1 rounded shadow-xl mb-4 border border-white/10 w-48 text-center leading-relaxed">Coming Soon: runtime PO token provider controls.</span><button type=button disabled aria-disabled=true aria-label="PO Token Extension toggle (Coming Soon)"class="w-12 h-6 bg-white/10 rounded-full flex items-center px-1 border border-white/10 cursor-not-allowed opacity-70"><span class="w-4 h-4 bg-white rounded-full">');function Ea(){return Ma()}const La=/\.(mp3|wav|ogg|flac|m4a|opus|aac|alac|wma)$/i,Oa=/\.(mp4|webm|mov|avi|mkv|m4v|wmv|mpeg|mpg|ts|ogv|3gp)$/i,Da=e=>La.test(String(e||"")),Ua=e=>Oa.test(String(e||"")),ja=e=>{const t=String(e||"").trim().toLowerCase();return t==="audio"?"audio":t==="video"?"video":"unknown"},Il=e=>{const t=String((e==null?void 0:e.filename)||"").trim();if(t!==""){if(Da(t))return"audio";if(Ua(t))return"video"}return ja(e==null?void 0:e.type)};var fl=C('<img class="w-full h-full object-cover">'),Fa=C('<div class="py-8 text-center"><p class="text-xs text-gray-500">Unsupported media type'),za=C('<div><div><span class="text-[10px] font-black text-blue-500 uppercase tracking-widest">Now Playing</span><div class="flex items-center gap-1"><button class="p-1 rounded-lg text-gray-500 hover:text-gray-300 hover:bg-white/5 transition-colors"title="Minimize player"></button><button class="p-1 rounded-lg text-gray-500 hover:text-red-300 hover:bg-red-500/10 transition-colors"title="Close player"></button></div></div><div class="flex items-start gap-4 min-w-0"><div class="w-24 h-24 shrink-0 rounded-2xl border border-white/10 bg-[#0b0f1a] overflow-hidden flex items-center justify-center"></div><div class="min-w-0 flex-1 space-y-2"><div class="font-bold text-white text-base leading-snug break-words"></div><div class="text-sm text-gray-300 truncate"></div><div class="flex flex-wrap gap-2 text-[10px] font-semibold uppercase tracking-wide"><span class="px-2 py-1 rounded-full bg-white/5 border border-white/10 text-gray-300"></span><span class="px-2 py-1 rounded-full bg-white/5 border border-white/10 text-gray-400"></span><span class="px-2 py-1 rounded-full bg-white/5 border border-white/10 text-gray-400"></span></div></div></div><div class="w-full rounded-2xl border border-white/10 bg-[#06080f] overflow-hidden">'),Ra=C('<div><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"><div class="flex items-center gap-3 min-w-0"><div class="w-12 h-12 shrink-0 rounded-xl border border-white/10 bg-[#0b0f1a] overflow-hidden flex items-center justify-center"></div><div class=min-w-0><div class="text-xs font-bold text-white truncate"></div><div class="text-[11px] text-gray-400 truncate"></div></div></div><div class="flex items-center justify-end gap-2"><button title="Toggle playback"><span class="inline-flex items-center gap-1.5"></span></button><button title="Next in queue"><span class="inline-flex items-center gap-1.5">Next</span></button><button class="px-3 py-1.5 rounded-lg text-xs font-semibold border border-white/10 bg-white/5 text-gray-200 hover:text-white hover:border-white/20 transition-all"title="Open queue"><span class="inline-flex items-center gap-1.5">Queue</span></button><button class="p-1.5 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-white/5 transition-colors"title="Restore player"></button><button class="p-1.5 rounded-lg text-gray-400 hover:text-red-300 hover:bg-red-500/10 transition-colors"title="Close player">'),Ka=C('<div class=aspect-video><video controls autoplay class="w-full h-full object-contain bg-black">'),Ia=C("<div class=p-3><audio controls autoplay class=w-full>");const Mt=12,Rt=(...e)=>{for(const t of e)if(typeof t=="string"){const n=t.trim();if(n!=="")return n}return""},bl=(e,t,n)=>Math.min(Math.max(e,t),n);function qa(e){let t,n=null;const l=z(()=>typeof e.media=="function"?e.media():e.media),r=z(()=>{var v;return(v=l())!=null&&v.metadata&&typeof l().metadata=="object"?l().metadata:{}}),i=z(()=>!!(typeof e.minimized=="function"?e.minimized():e.minimized)),o=z(()=>{const v=typeof e.queueCount=="function"?e.queueCount():e.queueCount,W=Number(v);return Number.isFinite(W)?Math.max(0,Math.trunc(W)):0}),c=z(()=>!!(typeof e.canGoNext=="function"?e.canGoNext():e.canGoNext)),u=z(()=>Il(l())),$=z(()=>u()==="video"),P=z(()=>u()==="audio"),p=z(()=>{var v;return Rt((v=l())==null?void 0:v.title,r().title,"Unknown title")}),j=z(()=>{var v;return Rt((v=l())==null?void 0:v.artist,r().artist,r().author,"Unknown artist")}),J=z(()=>{var v;return Rt((v=l())==null?void 0:v.album,r().album,j(),"Unknown collection")}),le=z(()=>{var v,W,Z;return Rt((W=(v=l())==null?void 0:v.playlist)==null?void 0:W.title,(Z=r().playlist)==null?void 0:Z.title,"Standalone")}),re=z(()=>u()==="audio"?"Audio":u()==="video"?"Video":"Unknown"),V=z(()=>{var v,W,Z;return Rt((v=l())==null?void 0:v.thumbnail_url,(W=l())==null?void 0:W.thumbnailUrl,(Z=l())==null?void 0:Z.thumbnailURL,r().thumbnail_url,r().thumbnailUrl,r().thumbnailURL)}),[se,_e]=Ie(""),[fe,F]=Ie(null),[Pe,Se]=Ie(!1),[Te,Be]=Ie(null),[Ve,ke]=Ie(!1),Me=z(()=>V()!==""&&se()!==V()),tt=z(()=>u()==="audio"?"music":u()==="video"?"film":"play-circle"),Ee=z(()=>u()==="audio"?"w-8 h-8 text-blue-300/70":u()==="video"?"w-8 h-8 text-emerald-300/70":"w-8 h-8 text-gray-400/70"),Le=z(()=>{const v=fe();if(v)return{left:`${v.left}px`,top:`${v.top}px`,right:"auto",bottom:"auto"}}),Ae=()=>{const v=Te();ke(!!(v&&!v.paused&&!v.ended))},ot=(v,W,Z,De)=>{if(typeof window>"u")return{left:v,top:W};const Oe=Math.max(Mt,window.innerWidth-Z-Mt),K=Math.max(Mt,window.innerHeight-De-Mt);return{left:bl(v,Mt,Oe),top:bl(W,Mt,K)}},Fe=()=>{n=null,Se(!1)},ct=v=>{if(!n||v.pointerId!==n.pointerId||i())return;const W=v.clientX-n.offsetX,Z=v.clientY-n.offsetY;F(ot(W,Z,n.width,n.height))},Je=v=>{var W,Z;!n||v.pointerId!==n.pointerId||((Z=(W=v.currentTarget)==null?void 0:W.hasPointerCapture)!=null&&Z.call(W,v.pointerId)&&v.currentTarget.releasePointerCapture(v.pointerId),Fe())},Ge=v=>{var Oe,K;if(i()||v.button!==0||v.target instanceof Element&&v.target.closest("button"))return;const W=t;if(!W)return;const Z=W.getBoundingClientRect(),De=ot(Z.left,Z.top,Z.width,Z.height);n={pointerId:v.pointerId,offsetX:v.clientX-Z.left,offsetY:v.clientY-Z.top,width:Z.width,height:Z.height},F(De),Se(!0),(K=(Oe=v.currentTarget).setPointerCapture)==null||K.call(Oe,v.pointerId),v.preventDefault()},ze=async()=>{const v=Te();if(v){if(v.paused||v.ended)try{await v.play()}catch{return}else v.pause();Ae()}},pt=()=>{const v=fe();if(!t||!v)return;const W=t.getBoundingClientRect();F(ot(v.left,v.top,W.width,W.height))},xt=v=>{Be(v??null),v||ke(!1)};return gt(()=>{V(),_e("")}),gt(()=>{var v;(v=l())==null||v.url,ke(!1)}),gt(()=>{!$()&&!P()&&(Be(null),ke(!1))}),gt(()=>{i()&&Fe()}),gn(()=>{var W;const v=n==null?void 0:n.pointerId;t&&typeof v=="number"&&((W=t.hasPointerCapture)!=null&&W.call(t,v))&&t.releasePointerCapture(v),Fe(),typeof window<"u"&&window.removeEventListener("resize",pt)}),typeof window<"u"&&window.addEventListener("resize",pt),[(()=>{var v=za(),W=v.firstChild,Z=W.firstChild,De=Z.nextSibling,Oe=De.firstChild,K=Oe.nextSibling,s=W.nextSibling,y=s.firstChild,g=y.nextSibling,S=g.firstChild,b=S.nextSibling,M=b.nextSibling,w=M.firstChild,I=w.nextSibling,Q=I.nextSibling,oe=s.nextSibling,ge=t;return typeof ge=="function"?sn(ge,v):t=v,W.addEventListener("pointercancel",Je),W.$$pointerup=Je,W.$$pointermove=ct,W.$$pointerdown=Ge,Oe.$$click=()=>{typeof e.onMinimize=="function"&&e.onMinimize()},a(Oe,f(ie,{name:"chevron-down",class:"w-4 h-4"})),K.$$click=()=>{typeof e.onClose=="function"&&e.onClose()},a(K,f(ie,{name:"x",class:"w-4 h-4"})),a(y,f(L,{get when(){return Me()},get fallback(){return f(ie,{get name(){return tt()},get class(){return Ee()}})},get children(){var d=fl();return d.addEventListener("error",()=>_e(V())),U(h=>{var A=V(),x=`Thumbnail for ${p()}`;return A!==h.e&&be(d,"src",h.e=A),x!==h.t&&be(d,"alt",h.t=x),h},{e:void 0,t:void 0}),d}})),a(S,p),a(b,j),a(w,re),a(I,J),a(Q,le),a(oe,f(L,{get when(){return et(()=>!!$())()?l():null},keyed:!0,children:d=>(()=>{var h=Ka(),A=h.firstChild;return A.addEventListener("ended",Ae),A.addEventListener("loadedmetadata",Ae),A.addEventListener("pause",Ae),A.addEventListener("play",Ae),sn(xt,A),U(x=>{var ce=d==null?void 0:d.url,Ue=V()||void 0;return ce!==x.e&&be(A,"src",x.e=ce),Ue!==x.t&&be(A,"poster",x.t=Ue),x},{e:void 0,t:void 0}),h})()}),null),a(oe,f(L,{get when(){return et(()=>!!P())()?l():null},keyed:!0,children:d=>(()=>{var h=Ia(),A=h.firstChild;return A.addEventListener("ended",Ae),A.addEventListener("loadedmetadata",Ae),A.addEventListener("pause",Ae),A.addEventListener("play",Ae),sn(xt,A),U(()=>be(A,"src",d==null?void 0:d.url)),h})()}),null),a(oe,f(L,{get when(){return et(()=>!$())()&&!P()},get children(){var d=Fa(),h=d.firstChild;return a(d,f(ie,{name:"play-circle",class:"w-10 h-10 text-blue-600/50 mx-auto mb-2"}),h),d}}),null),U(d=>{var h=`fixed bottom-6 right-6 w-[32rem] max-w-[calc(100vw-1.5rem)] glass rounded-[2rem] border border-white/10 shadow-2xl p-6 space-y-5 z-50 ${i()?"hidden":"animate-in slide-in-from-bottom-10 duration-500"}`,A=Le(),x=`flex items-center justify-between ${Pe()?"cursor-grabbing":"cursor-move"}`;return h!==d.e&&pe(v,d.e=h),d.t=Nl(v,A,d.t),x!==d.a&&pe(W,d.a=x),d},{e:void 0,t:void 0,a:void 0}),v})(),(()=>{var v=Ra(),W=v.firstChild,Z=W.firstChild,De=Z.firstChild,Oe=De.nextSibling,K=Oe.firstChild,s=K.nextSibling,y=Z.nextSibling,g=y.firstChild,S=g.firstChild,b=g.nextSibling,M=b.firstChild,w=M.firstChild,I=b.nextSibling,Q=I.firstChild,oe=Q.firstChild,ge=I.nextSibling,d=ge.nextSibling;return a(De,f(L,{get when(){return Me()},get fallback(){return f(ie,{get name(){return tt()},class:"w-5 h-5 text-gray-400/70"})},get children(){var h=fl();return h.addEventListener("error",()=>_e(V())),U(A=>{var x=V(),ce=`Thumbnail for ${p()}`;return x!==A.e&&be(h,"src",A.e=x),ce!==A.t&&be(h,"alt",A.t=ce),A},{e:void 0,t:void 0}),h}})),a(K,p),a(s,j),g.$$click=ze,a(S,f(ie,{get name(){return Ve()?"pause":"play"},class:"w-3.5 h-3.5"}),null),a(S,()=>Ve()?"Pause":"Play",null),b.$$click=()=>{typeof e.onNext=="function"&&e.onNext()},a(M,f(ie,{name:"skip-forward",class:"w-3.5 h-3.5"}),w),I.$$click=()=>{typeof e.onQueue=="function"&&e.onQueue()},a(Q,f(ie,{name:"layers",class:"w-3.5 h-3.5"}),oe),a(Q,(()=>{var h=et(()=>o()>0);return()=>h()?` (${o()})`:""})(),null),ge.$$click=()=>{typeof e.onRestore=="function"&&e.onRestore()},a(ge,f(ie,{name:"chevron-down",class:"w-4 h-4 rotate-180"})),d.$$click=()=>{typeof e.onClose=="function"&&e.onClose()},a(d,f(ie,{name:"x",class:"w-4 h-4"})),U(h=>{var A=`fixed bottom-4 right-4 w-[34rem] max-w-[calc(100vw-1.5rem)] glass rounded-2xl border border-white/10 shadow-2xl p-3 z-50 ${i()?"animate-in slide-in-from-bottom-10 duration-300":"hidden"}`,x=!Te(),ce=`px-3 py-1.5 rounded-lg text-xs font-semibold border transition-all ${Te()?"border-white/10 bg-white/5 text-gray-200 hover:text-white hover:border-white/20":"border-white/5 bg-white/5 text-gray-500 cursor-not-allowed"}`,Ue=!c(),je=`px-3 py-1.5 rounded-lg text-xs font-semibold border transition-all ${c()?"border-white/10 bg-white/5 text-gray-200 hover:text-white hover:border-white/20":"border-white/5 bg-white/5 text-gray-500 cursor-not-allowed"}`;return A!==h.e&&pe(v,h.e=A),x!==h.t&&(g.disabled=h.t=x),ce!==h.a&&pe(g,h.a=ce),Ue!==h.o&&(b.disabled=h.o=Ue),je!==h.i&&pe(b,h.i=je),h},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),v})()]}jt(["pointerdown","pointermove","pointerup","click"]);var yl=C('<div class="max-w-4xl mx-auto">'),Ba=C('<div class="flex h-screen bg-[radial-gradient(circle_at_12%_8%,rgba(56,189,248,0.16),transparent_35%),radial-gradient(circle_at_88%_2%,rgba(20,184,166,0.14),transparent_30%),linear-gradient(180deg,#05070a,#070b12_45%,#05070a)] text-gray-200 overflow-hidden font-sans select-none"><aside class="w-72 bg-[#0a0f17]/85 border-r border-white/10 flex flex-col p-6 backdrop-blur-xl"><div class="flex items-center gap-3 mb-10 px-2"><div class="w-10 h-10 bg-blue-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-600/20"></div><span class="text-xl font-bold tracking-tight text-white">ytdl-go</span></div><nav class="flex-1 space-y-1"><button><span class="font-semibold text-sm">New Download</span></button><button><span class="font-semibold text-sm">Library</span></button><button><span class="font-semibold text-sm">Configurations</span></button></nav><div class="mt-auto relative has-tooltip"><span class="tooltip bg-gray-800 text-[10px] px-2 py-1 rounded shadow-xl mb-4 border border-white/10 w-56 text-center leading-relaxed">Coming Soon: extension provider management and health status.</span><button type=button disabled aria-disabled=true aria-label="Extensions panel (Coming Soon)"class="w-full p-4 bg-white/5 rounded-2xl border border-white/5 opacity-70 cursor-not-allowed text-left"><div class="flex items-center gap-2 mb-2 text-xs font-bold text-gray-500 uppercase tracking-widest">Extensions</div><div class="flex items-center justify-between text-xs"><span class=text-gray-500>PO Token Provider</span><span class="px-2 py-0.5 bg-white/10 text-gray-500 rounded-full font-bold border border-white/10">Coming Soon</span></div></button></div></aside><main class="flex-1 flex flex-col bg-transparent relative"><header class="h-20 border-b border-white/5 flex items-center justify-between px-10 glass sticky top-0 z-20"><h2 class="text-lg font-bold text-white capitalize"></h2><div class="flex items-center gap-6"><div class="relative has-tooltip"><span class="tooltip bg-gray-800 text-[10px] px-2 py-1 rounded shadow-xl mb-4 border border-white/10 w-56 text-center leading-relaxed">Coming Soon: live auth cookie status and diagnostics.</span><button type=button disabled aria-disabled=true aria-label="YouTube auth status details (Coming Soon)"class="flex items-center gap-3 px-4 py-2 bg-white/5 rounded-full border border-white/5 cursor-not-allowed opacity-70"><div class="w-2 h-2 bg-gray-500 rounded-full"></div><span class="text-xs font-bold text-gray-400 italic">YT_AUTH_OK</span></button></div><button>Advanced Mode</button></div></header><div class="flex-1 overflow-y-auto p-10 custom-scrollbar"><div>');const Va=e=>{if(!e||typeof e!="object")return 0;const t=Number(e.succeeded);return Number.isFinite(t)?Math.max(0,Math.trunc(t)):0},Ga=(e,t)=>{const n=Rl(e);return n==="complete"?!0:n!=="error"?!1:Va(t)>0},Ya=e=>String(e||"").split("/").map(t=>encodeURIComponent(t)).join("/"),ln=e=>String(e||"").trim(),Qa=80,hl="/api/library/playlists",Wa="/api/library/playlists/migrate",gl="ytdl-go:saved-playlists:backend-migration:v1",En=e=>String(e||"").trim().replace(/\s+/g," ").slice(0,Qa),Lt=e=>String(e||"").trim(),ql=e=>String(e||"").trim(),Xa=e=>{const t=e&&typeof e=="object"?e:{},n=Lt(t.id),l=En(t.name);return n===""||l===""?null:{id:n,name:l,createdAt:typeof t.createdAt=="string"?t.createdAt.trim():"",updatedAt:typeof t.updatedAt=="string"?t.updatedAt.trim():""}},Ha=e=>{if(!Array.isArray(e))return[];const t=[],n=new Set,l=new Set;for(const r of e){const i=Xa(r);if(!i||n.has(i.id))continue;const o=i.name.toLowerCase();l.has(o)||(n.add(i.id),l.add(o),t.push(i))}return t},Ja=(e,t)=>{const n=e&&typeof e=="object"?e:{},l={};for(const[r,i]of Object.entries(n)){const o=ql(r),c=Lt(i);o===""||c===""||!t.has(c)||(l[o]=c)}return l},St=e=>{const t=e&&typeof e=="object"?e:{},n=Ha(t.playlists),l=new Set(n.map(r=>r.id));return{playlists:n,assignments:Ja(t.assignments,l)}},Sn=e=>Array.isArray(e==null?void 0:e.playlists)&&e.playlists.length>0||(e==null?void 0:e.assignments)&&typeof e.assignments=="object"&&Object.keys(e.assignments).length>0,ml=(e,t,n="")=>e.some(l=>l.id!==n&&l.name.localeCompare(t,void 0,{sensitivity:"base"})===0),Za=()=>typeof globalThis<"u"&&globalThis.crypto&&typeof globalThis.crypto.randomUUID=="function"?globalThis.crypto.randomUUID():`saved-${Date.now()}-${Math.random().toString(36).slice(2,10)}`,kn=async(e,t)=>{try{const n=await e.json();if(n&&typeof n.error=="string"&&n.error.trim()!=="")return n.error.trim()}catch{}return t},Kt=e=>e&&typeof e=="object"&&e.name==="AbortError";function eo(){const{state:e,setState:t}=zl(),[n,l]=Ie(""),[r,i]=Ie([]);let o=null,c=null,u=null,$=0,P=0,p=Promise.resolve(),j="",J="",le=null,re=!1;const V=()=>e.ui.activeTab,se=()=>e.ui.isAdvanced,_e=()=>e.download.jobStatus,fe=s=>{t("ui","activeTab",s)},F=()=>{t("ui","isAdvanced",s=>!s)},Pe=()=>{fe("library")},Se=()=>{le&&(clearTimeout(le),le=null)},Te=s=>{const y=p.then(s,s);return p=y.catch(()=>{}),y},Be=()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem(gl)==="1"}catch{return!1}},Ve=()=>{if(!(typeof window>"u"))try{window.localStorage.setItem(gl,"1")}catch{}},ke=()=>St({playlists:e.library.savedPlaylists,assignments:e.library.playlistAssignments}),Me=s=>{const y=St(s),g=new Set(y.playlists.map(S=>S.id));t("library","savedPlaylists",y.playlists),t("library","playlistAssignments",y.assignments),t("library","filters","savedPlaylistId",S=>g.has(Lt(S))?S:"")},tt=async s=>{const y=await fetch(hl,{signal:s});if(!y.ok)throw new Error(await kn(y,"Unable to load saved playlists from backend."));const g=await y.json();return St(g)},Ee=async(s,y)=>{const g=St(s),S=await fetch(hl,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(g),signal:y});if(!S.ok)throw new Error(await kn(S,"Unable to persist saved playlists."));const b=await S.json();return St(b)},Le=async(s,y)=>{const g=St(s),S=await fetch(Wa,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g),signal:y});if(!S.ok)throw new Error(await kn(S,"Unable to migrate saved playlists."));const b=await S.json();return{state:St(b),migrated:!!(b&&b.migrated)}},Ae=async s=>{P+=1;const y=P;u&&u.abort();const g=new AbortController;u=g;try{const S=await Ee(s,g.signal);return!re&&y===P&&(Me(S),l("")),S}finally{u===g&&(u=null)}},ot=async()=>{c&&c.abort();const s=new AbortController;c=s;const y=P,g=ke();try{const S=await tt(s.signal);if(re||s.signal.aborted||P!==y)return;if(Me(S),l(""),Sn(S)){Ve();return}if(!Sn(g)){Be()||Ve();return}const b=await Le(g,s.signal);if(re||s.signal.aborted||P!==y)return;Me(b.state),(b.migrated||Sn(b.state))&&Ve()}catch(S){if(Kt(S)||s.signal&&s.signal.aborted)return;const b=S instanceof Error?S.message:"Failed to initialize saved playlists.";l(b),console.error("Failed to initialize saved playlists:",S)}finally{c===s&&(c=null)}},Fe=async()=>{if(re)return!1;o&&o.abort(),o=new AbortController;const s=++$;try{const y=await fetch("/api/media/",{signal:o.signal});if(y.ok){const g=await y.json();if(re||s!==$)return!1;const S=Array.isArray(g)?g:g.items||[];return t("library","downloads",S),!0}return!1}catch(y){return y&&typeof y=="object"&&y.name==="AbortError"||console.error("Failed to fetch media files:",y),!1}finally{s===$&&(o=null)}},ct=async()=>await Fe()?{ok:!0,message:"Library refreshed. Legacy files without sidecars may still need re-download for complete metadata and thumbnails."}:{ok:!1,message:"Unable to refresh metadata right now. Please retry in a few seconds."},Je=async(s,y=1)=>{if(!s||re)return;J=s;const g=await Fe();if(!(re||J!==s)){if(g){j=s,J="",Se();return}if(y>=3){J="";return}Se(),le=setTimeout(()=>{le=null,Je(s,y+1)},y*1e3)}};wl(()=>{Fe(),ot()}),gt(()=>{V()==="library"&&Fe()}),gt(()=>{const s=_e(),y=s==null?void 0:s.jobId;typeof y!="string"||y===""||y===j||y===J||Ga(s==null?void 0:s.status,s==null?void 0:s.stats)&&Je(y,1)}),gn(()=>{re=!0,Se(),o&&(o.abort(),o=null),c&&(c.abort(),c=null),u&&(u.abort(),u=null)});const Ge=s=>({...s,url:`/api/media/${Ya(s.filename)}`}),ze=(s,y)=>{const g=Array.isArray(e.library.downloads)?e.library.downloads:[],S=Array.isArray(s)&&s.length>0?s:g,b=[],M=new Set;for(const I of S){if(!I||typeof I!="object")continue;const Q=ln(I.filename);Q===""||M.has(Q)||(M.add(Q),b.push(I))}const w=ln(y==null?void 0:y.filename);return w!==""&&!M.has(w)&&b.unshift(y),b},pt=(s,y)=>{if(!s||typeof s!="object"||String(s.filename||"").trim()==="")return;const g=ze(y,s);i(g),t("player","selectedMedia",Ge(s)),t("player","minimized",!1),t("player","active",!0)},xt=()=>{t("player","active",!1),t("player","selectedMedia",null),t("player","minimized",!1),i([])},v=()=>{const s=e.player.selectedMedia;if(s){const y=Il(s);(y==="audio"||y==="video")&&t("library","typeFilter",y)}t("library","section","all_media"),t("library","navPath",{creatorType:"",creatorName:"",albumName:"",playlistKey:"",playlistKind:""}),fe("library")},W=()=>{var M;const s=r();if(s.length===0)return;const y=ln((M=e.player.selectedMedia)==null?void 0:M.filename),g=s.findIndex(w=>ln(w.filename)===y),S=g<0?0:(g+1)%s.length,b=s[S];b&&(t("player","selectedMedia",Ge(b)),t("player","active",!0))},Z=s=>Te(async()=>{const y=En(s);if(y==="")return{ok:!1,error:"Playlist name is required."};const g=ke();if(ml(g.playlists,y))return{ok:!1,error:"A playlist with that name already exists."};const S=new Date().toISOString(),b={id:Za(),name:y,createdAt:S,updatedAt:S};try{const w=(await Ae({playlists:[...g.playlists,b],assignments:g.assignments})).playlists.find(I=>I.id===b.id);return w?{ok:!0,playlist:w}:{ok:!1,error:"A playlist with that name already exists."}}catch(M){return Kt(M)?{ok:!1,error:"Request canceled."}:{ok:!1,error:M instanceof Error?M.message:"Unable to create saved playlist."}}}),De=(s,y)=>Te(async()=>{const g=Lt(s),S=En(y);if(g==="")return{ok:!1,error:"Playlist not found."};if(S==="")return{ok:!1,error:"Playlist name is required."};const b=ke();if(!b.playlists.some(Q=>Q.id===g))return{ok:!1,error:"Playlist not found."};if(ml(b.playlists,S,g))return{ok:!1,error:"A playlist with that name already exists."};const w=new Date().toISOString(),I=b.playlists.map(Q=>Q.id===g?{...Q,name:S,updatedAt:w}:Q);try{const oe=(await Ae({playlists:I,assignments:b.assignments})).playlists.find(ge=>ge.id===g);return oe?oe.name.localeCompare(S,void 0,{sensitivity:"base"})!==0?{ok:!1,error:"A playlist with that name already exists."}:{ok:!0}:{ok:!1,error:"Playlist not found."}}catch(Q){return Kt(Q)?{ok:!1,error:"Request canceled."}:{ok:!1,error:Q instanceof Error?Q.message:"Unable to rename saved playlist."}}}),Oe=s=>Te(async()=>{const y=Lt(s);if(y==="")return{ok:!1,error:"Playlist not found."};const g=ke(),S=g.playlists.filter(M=>M.id!==y);if(S.length===g.playlists.length)return{ok:!1,error:"Playlist not found."};const b={};for(const[M,w]of Object.entries(g.assignments))w!==y&&(b[M]=w);try{return await Ae({playlists:S,assignments:b}),{ok:!0}}catch(M){return Kt(M)?{ok:!1,error:"Request canceled."}:{ok:!1,error:M instanceof Error?M.message:"Unable to delete saved playlist."}}}),K=(s,y)=>Te(async()=>{const g=ql(s),S=Lt(y);if(g==="")return;const b=ke();if(!(S===""||b.playlists.some(I=>I.id===S)))return;const w={...b.assignments};if(S===""){if(!(g in w))return;delete w[g]}else{if(w[g]===S)return;w[g]=S}try{await Ae({playlists:b.playlists,assignments:w})}catch(I){if(Kt(I))return;console.error("Failed to assign saved playlist:",I)}});return(()=>{var s=Ba(),y=s.firstChild,g=y.firstChild,S=g.firstChild,b=g.nextSibling,M=b.firstChild,w=M.firstChild,I=M.nextSibling,Q=I.firstChild,oe=I.nextSibling,ge=oe.firstChild,d=b.nextSibling,h=d.firstChild,A=h.nextSibling,x=A.firstChild,ce=x.firstChild,Ue=y.nextSibling,je=Ue.firstChild,me=je.firstChild,nt=me.nextSibling,Ye=nt.firstChild,dt=Ye.firstChild,ut=dt.nextSibling,Qe=ut.firstChild;Qe.nextSibling;var E=Ye.nextSibling,ee=je.nextSibling,B=ee.firstChild;return a(S,f(ie,{name:"zap",class:"w-6 h-6 text-white fill-white"})),M.$$click=()=>fe("download"),a(M,f(ie,{name:"plus-circle",class:"w-5 h-5"}),w),I.$$click=()=>fe("library"),a(I,f(ie,{name:"layers",class:"w-5 h-5"}),Q),oe.$$click=()=>fe("settings"),a(oe,f(ie,{name:"sliders",class:"w-5 h-5"}),ge),a(x,f(ie,{name:"puzzle",class:"w-3 h-3"}),ce),a(me,V),a(ut,f(ie,{name:"chevron-down",class:"w-3 h-3 text-gray-500"}),null),E.$$click=F,a(B,f(Ps,{onOpenLibrary:Pe})),a(ee,f(L,{get when(){return V()==="library"},get children(){var ae=yl();return a(ae,f(Ta,{downloads:()=>e.library.downloads,section:()=>e.library.section,viewMode:()=>e.library.viewMode,typeFilter:()=>e.library.typeFilter,navPath:()=>e.library.navPath,filters:()=>e.library.filters,sortKey:()=>e.library.sortKey,uiState:()=>e.library.ui,savedPlaylists:()=>e.library.savedPlaylists,playlistAssignments:()=>e.library.playlistAssignments,onSectionChange:de=>t("library","section",de),onViewModeChange:de=>t("library","viewMode",de),onTypeFilterChange:de=>t("library","typeFilter",de),onNavPathChange:de=>t("library","navPath",de),onFilterChange:(de,Re)=>t("library","filters",de,Re),onClearFilters:()=>t("library","filters",{query:"",creator:"",collection:"",playlist:"",savedPlaylistId:""}),onToggleAdvancedFilters:()=>t("library","ui","advancedFiltersOpen",de=>!de),onDismissMetadataBanner:()=>t("library","ui","metadataBannerDismissed",!0),onRetryMetadataScan:ct,onSortKeyChange:de=>t("library","sortKey",de),onCreateSavedPlaylist:Z,onRenameSavedPlaylist:De,onDeleteSavedPlaylist:Oe,onAssignSavedPlaylist:K,savedPlaylistSyncError:()=>n(),onRetrySavedPlaylistSync:()=>{ot()},openPlayer:pt})),ae}}),null),a(ee,f(L,{get when(){return V()==="settings"},get children(){var ae=yl();return a(ae,f(Ea,{})),ae}}),null),a(Ue,(()=>{var ae=et(()=>!!e.player.active);return()=>ae()&&f(qa,{get media(){return e.player.selectedMedia},minimized:()=>e.player.minimized,queueCount:()=>r().length,canGoNext:()=>r().length>1,onMinimize:()=>t("player","minimized",!0),onRestore:()=>t("player","minimized",!1),onNext:W,onQueue:v,onClose:xt})})(),null),U(ae=>{var de=`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${V()==="download"?"bg-blue-600/10 text-blue-400":"text-gray-500 hover:bg-white/5 hover:text-gray-300"}`,Re=`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${V()==="library"?"bg-blue-600/10 text-blue-400":"text-gray-500 hover:bg-white/5 hover:text-gray-300"}`,k=`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${V()==="settings"?"bg-blue-600/10 text-blue-400":"text-gray-500 hover:bg-white/5 hover:text-gray-300"}`,m=`px-4 py-2 rounded-full text-xs font-bold transition-all ${se()?"bg-blue-600 text-white shadow-lg shadow-blue-600/20":"bg-white/5 text-gray-500 hover:text-gray-300"}`,D=`max-w-4xl mx-auto ${V()==="download"?"":"hidden"}`;return de!==ae.e&&pe(M,ae.e=de),Re!==ae.t&&pe(I,ae.t=Re),k!==ae.a&&pe(oe,ae.a=k),m!==ae.o&&pe(E,ae.o=m),D!==ae.i&&pe(B,ae.i=D),ae},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),s})()}jt(["click"]);const to=document.getElementById("root");mr(()=>f(ls,{get children(){return f(eo,{})}}),to);
