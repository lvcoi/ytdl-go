import{j as d,p as Se,h as R,l as H,q as Le,i as a,c as f,I as m,b as L,s as k,S as U,r as ne,m as O,d as D,v as Pe,t as I,g as Ie}from"../app.js";var ge=I('<img class="w-full h-full object-cover">'),Me=I('<div class="py-8 text-center"><p class="text-xs text-gray-500">Unsupported media type'),Ne=I('<div><div><span class="text-[10px] font-black text-blue-500 uppercase tracking-widest">Now Playing</span><div class="flex items-center gap-1"><button class="p-1 rounded-lg text-gray-500 hover:text-gray-300 hover:bg-white/5 transition-colors"title="Minimize player"></button><button class="p-1 rounded-lg text-gray-500 hover:text-red-300 hover:bg-red-500/10 transition-colors"title="Close player"></button></div></div><div class="flex items-start gap-4 min-w-0"><div class="w-24 h-24 shrink-0 rounded-2xl border border-white/10 bg-[#0b0f1a] overflow-hidden flex items-center justify-center"></div><div class="min-w-0 flex-1 space-y-2"><div class="font-bold text-white text-base leading-snug break-words"></div><div class="text-sm text-gray-300 truncate"></div><div class="flex flex-wrap gap-2 text-[10px] font-semibold uppercase tracking-wide"><span class="px-2 py-1 rounded-full bg-white/5 border border-white/10 text-gray-300"></span><span class="px-2 py-1 rounded-full bg-white/5 border border-white/10 text-gray-400"></span><span class="px-2 py-1 rounded-full bg-white/5 border border-white/10 text-gray-400"></span></div></div></div><div class="w-full rounded-2xl border border-white/10 bg-[#06080f] overflow-hidden">'),Te=I('<div><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"><div class="flex items-center gap-3 min-w-0"><div class="w-12 h-12 shrink-0 rounded-xl border border-white/10 bg-[#0b0f1a] overflow-hidden flex items-center justify-center"></div><div class=min-w-0><div class="text-xs font-bold text-white truncate"></div><div class="text-[11px] text-gray-400 truncate"></div></div></div><div class="flex items-center justify-end gap-2"><button title="Toggle playback"><span class="inline-flex items-center gap-1.5"></span></button><button title="Next in queue"><span class="inline-flex items-center gap-1.5">Next</span></button><button class="px-3 py-1.5 rounded-lg text-xs font-semibold border border-white/10 bg-white/5 text-gray-200 hover:text-white hover:border-white/20 transition-all"title="Open queue"><span class="inline-flex items-center gap-1.5">Queue</span></button><button class="p-1.5 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-white/5 transition-colors"title="Restore player"></button><button class="p-1.5 rounded-lg text-gray-400 hover:text-red-300 hover:bg-red-500/10 transition-colors"title="Close player">'),ze=I('<div class=aspect-video><video controls autoplay class="w-full h-full object-contain bg-black">'),je=I("<div class=p-3><audio controls autoplay class=w-full>");const P=12,q=(...i)=>{for(const u of i)if(typeof u=="string"){const s=u.trim();if(s!=="")return s}return""},me=(i,u,s)=>Math.min(Math.max(i,u),s);function Ue(i){let u,s=null;const h=d(()=>typeof i.media=="function"?i.media():i.media),v=d(()=>{var e;return(e=h())!=null&&e.metadata&&typeof h().metadata=="object"?h().metadata:{}}),M=d(()=>!!(typeof i.minimized=="function"?i.minimized():i.minimized)),ie=d(()=>{const e=typeof i.queueCount=="function"?i.queueCount():i.queueCount,t=Number(e);return Number.isFinite(t)?Math.max(0,Math.trunc(t)):0}),re=d(()=>!!(typeof i.canGoNext=="function"?i.canGoNext():i.canGoNext)),w=d(()=>Se(h())),W=d(()=>w()==="video"),J=d(()=>w()==="audio"),G=d(()=>{var e;return q((e=h())==null?void 0:e.title,v().title,"Unknown title")}),K=d(()=>{var e;return q((e=h())==null?void 0:e.artist,v().artist,v().author,"Unknown artist")}),xe=d(()=>{var e;return q((e=h())==null?void 0:e.album,v().album,K(),"Unknown collection")}),ve=d(()=>{var e,t,o;return q((t=(e=h())==null?void 0:e.playlist)==null?void 0:t.title,(o=v().playlist)==null?void 0:o.title,"Standalone")}),we=d(()=>w()==="audio"?"Audio":w()==="video"?"Video":"Unknown"),y=d(()=>{var e,t,o;return q((e=h())==null?void 0:e.thumbnail_url,(t=h())==null?void 0:t.thumbnailUrl,(o=h())==null?void 0:o.thumbnailURL,v().thumbnail_url,v().thumbnailUrl,v().thumbnailURL)}),[ye,Z]=R(""),[le,V]=R(null),[pe,oe]=R(!1),[A,ae]=R(null),[se,B]=R(!1),de=d(()=>y()!==""&&ye()!==y()),ce=d(()=>w()==="audio"?"music":w()==="video"?"film":"play-circle"),$e=d(()=>w()==="audio"?"w-8 h-8 text-blue-300/70":w()==="video"?"w-8 h-8 text-emerald-300/70":"w-8 h-8 text-gray-400/70"),_e=d(()=>{const e=le();if(e)return{left:`${e.left}px`,top:`${e.top}px`,right:"auto",bottom:"auto"}}),x=()=>{const e=A();B(!!(e&&!e.paused&&!e.ended))},ee=(e,t,o,p)=>{if(typeof window>"u")return{left:e,top:t};const b=Math.max(P,window.innerWidth-o-P),g=Math.max(P,window.innerHeight-p-P);return{left:me(e,P,b),top:me(t,P,g)}},te=()=>{s=null,oe(!1)},Ce=e=>{if(!s||e.pointerId!==s.pointerId||M())return;const t=e.clientX-s.offsetX,o=e.clientY-s.offsetY;V(ee(t,o,s.width,s.height))},ue=e=>{var t,o;!s||e.pointerId!==s.pointerId||((o=(t=e.currentTarget)==null?void 0:t.hasPointerCapture)!=null&&o.call(t,e.pointerId)&&e.currentTarget.releasePointerCapture(e.pointerId),te())},ke=e=>{var b,g;if(M()||e.button!==0||e.target instanceof Element&&e.target.closest("button"))return;const t=u;if(!t)return;const o=t.getBoundingClientRect(),p=ee(o.left,o.top,o.width,o.height);s={pointerId:e.pointerId,offsetX:e.clientX-o.left,offsetY:e.clientY-o.top,width:o.width,height:o.height},V(p),oe(!0),(g=(b=e.currentTarget).setPointerCapture)==null||g.call(b,e.pointerId),e.preventDefault()},Ee=async()=>{const e=A();if(e){if(e.paused||e.ended)try{await e.play()}catch{return}else e.pause();x()}},fe=()=>{const e=le();if(!u||!e)return;const t=u.getBoundingClientRect();V(ee(e.left,e.top,t.width,t.height))},he=e=>{ae(e??null),e||B(!1)};return H(()=>{y(),Z("")}),H(()=>{var e;(e=h())==null||e.url,B(!1)}),H(()=>{!W()&&!J()&&(ae(null),B(!1))}),H(()=>{M()&&te()}),Le(()=>{var t;const e=s==null?void 0:s.pointerId;u&&typeof e=="number"&&((t=u.hasPointerCapture)!=null&&t.call(u,e))&&u.releasePointerCapture(e),te(),typeof window<"u"&&window.removeEventListener("resize",fe)}),typeof window<"u"&&window.addEventListener("resize",fe),[(()=>{var e=Ne(),t=e.firstChild,o=t.firstChild,p=o.nextSibling,b=p.firstChild,g=b.nextSibling,Y=t.nextSibling,X=Y.firstChild,C=X.nextSibling,N=C.firstChild,$=N.nextSibling,F=$.nextSibling,Q=F.firstChild,E=Q.nextSibling,T=E.nextSibling,z=Y.nextSibling,S=u;return typeof S=="function"?ne(S,e):u=e,t.addEventListener("pointercancel",ue),t.$$pointerup=ue,t.$$pointermove=Ce,t.$$pointerdown=ke,b.$$click=()=>{typeof i.onMinimize=="function"&&i.onMinimize()},a(b,f(m,{name:"chevron-down",class:"w-4 h-4"})),g.$$click=()=>{typeof i.onClose=="function"&&i.onClose()},a(g,f(m,{name:"x",class:"w-4 h-4"})),a(X,f(U,{get when(){return de()},get fallback(){return f(m,{get name(){return ce()},get class(){return $e()}})},get children(){var l=ge();return l.addEventListener("error",()=>Z(y())),L(n=>{var r=y(),c=`Thumbnail for ${G()}`;return r!==n.e&&k(l,"src",n.e=r),c!==n.t&&k(l,"alt",n.t=c),n},{e:void 0,t:void 0}),l}})),a(N,G),a($,K),a(Q,we),a(E,xe),a(T,ve),a(z,f(U,{get when(){return O(()=>!!W())()?h():null},keyed:!0,children:l=>(()=>{var n=ze(),r=n.firstChild;return r.addEventListener("ended",x),r.addEventListener("loadedmetadata",x),r.addEventListener("pause",x),r.addEventListener("play",x),ne(he,r),L(c=>{var _=l==null?void 0:l.url,j=y()||void 0;return _!==c.e&&k(r,"src",c.e=_),j!==c.t&&k(r,"poster",c.t=j),c},{e:void 0,t:void 0}),n})()}),null),a(z,f(U,{get when(){return O(()=>!!J())()?h():null},keyed:!0,children:l=>(()=>{var n=je(),r=n.firstChild;return r.addEventListener("ended",x),r.addEventListener("loadedmetadata",x),r.addEventListener("pause",x),r.addEventListener("play",x),ne(he,r),L(()=>k(r,"src",l==null?void 0:l.url)),n})()}),null),a(z,f(U,{get when(){return O(()=>!W())()&&!J()},get children(){var l=Me(),n=l.firstChild;return a(l,f(m,{name:"play-circle",class:"w-10 h-10 text-blue-600/50 mx-auto mb-2"}),n),l}}),null),L(l=>{var n=`fixed bottom-6 right-6 w-[32rem] max-w-[calc(100vw-1.5rem)] glass rounded-[2rem] border border-white/10 shadow-2xl p-6 space-y-5 z-50 ${M()?"hidden":"animate-in slide-in-from-bottom-10 duration-500"}`,r=_e(),c=`flex items-center justify-between ${pe()?"cursor-grabbing":"cursor-move"}`;return n!==l.e&&D(e,l.e=n),l.t=Pe(e,r,l.t),c!==l.a&&D(t,l.a=c),l},{e:void 0,t:void 0,a:void 0}),e})(),(()=>{var e=Te(),t=e.firstChild,o=t.firstChild,p=o.firstChild,b=p.nextSibling,g=b.firstChild,Y=g.nextSibling,X=o.nextSibling,C=X.firstChild,N=C.firstChild,$=C.nextSibling,F=$.firstChild,Q=F.firstChild,E=$.nextSibling,T=E.firstChild,z=T.firstChild,S=E.nextSibling,l=S.nextSibling;return a(p,f(U,{get when(){return de()},get fallback(){return f(m,{get name(){return ce()},class:"w-5 h-5 text-gray-400/70"})},get children(){var n=ge();return n.addEventListener("error",()=>Z(y())),L(r=>{var c=y(),_=`Thumbnail for ${G()}`;return c!==r.e&&k(n,"src",r.e=c),_!==r.t&&k(n,"alt",r.t=_),r},{e:void 0,t:void 0}),n}})),a(g,G),a(Y,K),C.$$click=Ee,a(N,f(m,{get name(){return se()?"pause":"play"},class:"w-3.5 h-3.5"}),null),a(N,()=>se()?"Pause":"Play",null),$.$$click=()=>{typeof i.onNext=="function"&&i.onNext()},a(F,f(m,{name:"skip-forward",class:"w-3.5 h-3.5"}),Q),E.$$click=()=>{typeof i.onQueue=="function"&&i.onQueue()},a(T,f(m,{name:"layers",class:"w-3.5 h-3.5"}),z),a(T,(()=>{var n=O(()=>ie()>0);return()=>n()?` (${ie()})`:""})(),null),S.$$click=()=>{typeof i.onRestore=="function"&&i.onRestore()},a(S,f(m,{name:"chevron-down",class:"w-4 h-4 rotate-180"})),l.$$click=()=>{typeof i.onClose=="function"&&i.onClose()},a(l,f(m,{name:"x",class:"w-4 h-4"})),L(n=>{var r=`fixed bottom-4 right-4 w-[34rem] max-w-[calc(100vw-1.5rem)] glass rounded-2xl border border-white/10 shadow-2xl p-3 z-50 ${M()?"animate-in slide-in-from-bottom-10 duration-300":"hidden"}`,c=!A(),_=`px-3 py-1.5 rounded-lg text-xs font-semibold border transition-all ${A()?"border-white/10 bg-white/5 text-gray-200 hover:text-white hover:border-white/20":"border-white/5 bg-white/5 text-gray-500 cursor-not-allowed"}`,j=!re(),be=`px-3 py-1.5 rounded-lg text-xs font-semibold border transition-all ${re()?"border-white/10 bg-white/5 text-gray-200 hover:text-white hover:border-white/20":"border-white/5 bg-white/5 text-gray-500 cursor-not-allowed"}`;return r!==n.e&&D(e,n.e=r),c!==n.t&&(C.disabled=n.t=c),_!==n.a&&D(C,n.a=_),j!==n.o&&($.disabled=n.o=j),be!==n.i&&D($,n.i=be),n},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),e})()]}Ie(["pointerdown","pointermove","pointerup","click"]);export{Ue as default};
